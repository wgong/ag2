<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A programming framework for agentic AI"><meta name=author content="Chi Wang & Qingyun Wu"><link href=https://ag2ai.github.io/ag2/latest/docs/api-reference/autogen/ChatCompletion/ rel=canonical><link href=../Cache/ rel=prev><link href=../ChatResult/ rel=next><link rel=icon href=../../../../assets/img/favicon.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.4"><title>ChatCompletion - AG2</title><link rel=stylesheet href=../../../../assets/stylesheets/main.8608ea7d.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../css/timeago.css><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../stylesheets/extra.7747e8.min.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2GN2KN2CE4"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2GN2KN2CE4",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2GN2KN2CE4",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta http-equiv=Cache-Control content="no-cache, no-store, must-revalidate"><meta property=og:type content=website><meta property=og:title content="AG2 - ChatCompletion"><meta property=og:description content="A programming framework for agentic AI"><meta content=https://ag2ai.github.io/ag2/latest/docs/api-reference/autogen/ChatCompletion/ property=og:url><meta property=og:image content=https://opengraph.githubassets.com/1671805243.560327/ag2ai/ag2><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="AG2 - ChatCompletion"><meta name=twitter:description content="A programming framework for agentic AI"><meta name=twitter:image content=https://opengraph.githubassets.com/1671805243.560327/ag2ai/ag2><link href=../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#autogen.ChatCompletion class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> You're viewing the <strong class=primary-text>work in progress</strong> version of the documentation. Please click <a rel=me href=http://docs.ag2.ai><strong>here</strong></a> for the latest. </div> </aside> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest version. <a href=../../../../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=AG2 class="md-header__button md-logo" aria-label=AG2 data-md-component=logo> <img src=../../../../assets/img/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AG2 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> ChatCompletion </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ag2ai/ag2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ag2ai/ag2 </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../home/home/ class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../user-guide/basic-concepts/installing-ag2/ class=md-tabs__link> User Guide </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../AfterWork/ class=md-tabs__link> API References </a> </li> <li class=md-tabs__item> <a href=../../../contributor-guide/contributing/ class=md-tabs__link> Contributor Guide </a> </li> <li class=md-tabs__item> <a href=../../../faq/FAQ/ class=md-tabs__link> FAQs </a> </li> <li class=md-tabs__item> <a href=../../../ecosystem/agentops/ class=md-tabs__link> Ecosystem </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=AG2 class="md-nav__button md-logo" aria-label=AG2 data-md-component=logo> <img src=../../../../assets/img/logo.svg alt=logo> </a> AG2 </label> <div class=md-nav__source> <a href=https://github.com/ag2ai/ag2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ag2ai/ag2 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../home/home/ class=md-nav__link> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../user-guide/basic-concepts/installing-ag2/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> API References </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> API References </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> autogen </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> autogen </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../AfterWork/ class=md-nav__link> <span class=md-ellipsis> AfterWork </span> </a> </li> <li class=md-nav__item> <a href=../AfterWorkOption/ class=md-nav__link> <span class=md-ellipsis> AfterWorkOption </span> </a> </li> <li class=md-nav__item> <a href=../Agent/ class=md-nav__link> <span class=md-ellipsis> Agent </span> </a> </li> <li class=md-nav__item> <a href=../AgentNameConflictError/ class=md-nav__link> <span class=md-ellipsis> AgentNameConflictError </span> </a> </li> <li class=md-nav__item> <a href=../AssistantAgent/ class=md-nav__link> <span class=md-ellipsis> AssistantAgent </span> </a> </li> <li class=md-nav__item> <a href=../Cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> ChatCompletion </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> ChatCompletion </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#autogen.ChatCompletion class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ChatCompletion </span> </a> <nav class=md-nav aria-label= ChatCompletion> <ul class=md-nav__list> <li class=md-nav__item> <a href=#autogen.ChatCompletion.chat_models class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;chat_models </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.price1K class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;price1K </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.cache_seed class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cache_seed </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.cache_path class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cache_path </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.retry_wait_time class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;retry_wait_time </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.max_retry_period class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_retry_period </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.request_timeout class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;request_timeout </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.optimization_budget class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;optimization_budget </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.logged_history class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logged_history </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.default_search_space class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;default_search_space </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.openai_completion_class class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;openai_completion_class </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.set_cache class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_cache </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.clear_cache class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_cache </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.tune class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;tune </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.create class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.instantiate class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instantiate </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.test class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;test </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.cost class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cost </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.extract_text class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extract_text </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.extract_text_or_function_call class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extract_text_or_function_call </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.print_usage_summary class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;print_usage_summary </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.start_logging class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_logging </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.stop_logging class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_logging </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../ChatResult/ class=md-nav__link> <span class=md-ellipsis> ChatResult </span> </a> </li> <li class=md-nav__item> <a href=../Completion/ class=md-nav__link> <span class=md-ellipsis> Completion </span> </a> </li> <li class=md-nav__item> <a href=../ConversableAgent/ class=md-nav__link> <span class=md-ellipsis> ConversableAgent </span> </a> </li> <li class=md-nav__item> <a href=../GroupChat/ class=md-nav__link> <span class=md-ellipsis> GroupChat </span> </a> </li> <li class=md-nav__item> <a href=../GroupChatManager/ class=md-nav__link> <span class=md-ellipsis> GroupChatManager </span> </a> </li> <li class=md-nav__item> <a href=../InvalidCarryOverTypeError/ class=md-nav__link> <span class=md-ellipsis> InvalidCarryOverTypeError </span> </a> </li> <li class=md-nav__item> <a href=../ModelClient/ class=md-nav__link> <span class=md-ellipsis> ModelClient </span> </a> </li> <li class=md-nav__item> <a href=../NoEligibleSpeakerError/ class=md-nav__link> <span class=md-ellipsis> NoEligibleSpeakerError </span> </a> </li> <li class=md-nav__item> <a href=../OnCondition/ class=md-nav__link> <span class=md-ellipsis> OnCondition </span> </a> </li> <li class=md-nav__item> <a href=../OpenAIWrapper/ class=md-nav__link> <span class=md-ellipsis> OpenAIWrapper </span> </a> </li> <li class=md-nav__item> <a href=../ReasoningAgent/ class=md-nav__link> <span class=md-ellipsis> ReasoningAgent </span> </a> </li> <li class=md-nav__item> <a href=../SenderRequiredError/ class=md-nav__link> <span class=md-ellipsis> SenderRequiredError </span> </a> </li> <li class=md-nav__item> <a href=../ThinkNode/ class=md-nav__link> <span class=md-ellipsis> ThinkNode </span> </a> </li> <li class=md-nav__item> <a href=../UndefinedNextAgentError/ class=md-nav__link> <span class=md-ellipsis> UndefinedNextAgentError </span> </a> </li> <li class=md-nav__item> <a href=../UserProxyAgent/ class=md-nav__link> <span class=md-ellipsis> UserProxyAgent </span> </a> </li> <li class=md-nav__item> <a href=../a_initiate_swarm_chat/ class=md-nav__link> <span class=md-ellipsis> a_initiate_swarm_chat </span> </a> </li> <li class=md-nav__item> <a href=../config_list_from_dotenv/ class=md-nav__link> <span class=md-ellipsis> config_list_from_dotenv </span> </a> </li> <li class=md-nav__item> <a href=../config_list_from_json/ class=md-nav__link> <span class=md-ellipsis> config_list_from_json </span> </a> </li> <li class=md-nav__item> <a href=../config_list_from_models/ class=md-nav__link> <span class=md-ellipsis> config_list_from_models </span> </a> </li> <li class=md-nav__item> <a href=../config_list_gpt4_gpt35/ class=md-nav__link> <span class=md-ellipsis> config_list_gpt4_gpt35 </span> </a> </li> <li class=md-nav__item> <a href=../config_list_openai_aoai/ class=md-nav__link> <span class=md-ellipsis> config_list_openai_aoai </span> </a> </li> <li class=md-nav__item> <a href=../filter_config/ class=md-nav__link> <span class=md-ellipsis> filter_config </span> </a> </li> <li class=md-nav__item> <a href=../gather_usage_summary/ class=md-nav__link> <span class=md-ellipsis> gather_usage_summary </span> </a> </li> <li class=md-nav__item> <a href=../get_config_list/ class=md-nav__link> <span class=md-ellipsis> get_config_list </span> </a> </li> <li class=md-nav__item> <a href=../initiate_chats/ class=md-nav__link> <span class=md-ellipsis> initiate_chats </span> </a> </li> <li class=md-nav__item> <a href=../initiate_swarm_chat/ class=md-nav__link> <span class=md-ellipsis> initiate_swarm_chat </span> </a> </li> <li class=md-nav__item> <a href=../register_function/ class=md-nav__link> <span class=md-ellipsis> register_function </span> </a> </li> <li class=md-nav__item> <a href=../visualize_tree/ class=md-nav__link> <span class=md-ellipsis> visualize_tree </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../agentchat/chat/a_initiate_chats/ class=md-nav__link> <span class=md-ellipsis> agentchat </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../agents/contrib/TimeReplyAgent/ class=md-nav__link> <span class=md-ellipsis> agents </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../cache/AbstractCache/ class=md-nav__link> <span class=md-ellipsis> cache </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../coding/CodeBlock/ class=md-nav__link> <span class=md-ellipsis> coding </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../doc_utils/export_module/ class=md-nav__link> <span class=md-ellipsis> doc_utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../exception_utils/ModelToolNotSupportedError/ class=md-nav__link> <span class=md-ellipsis> exception_utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../import_utils/optional_import_block/ class=md-nav__link> <span class=md-ellipsis> import_utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../interop/CrewAIInteroperability/ class=md-nav__link> <span class=md-ellipsis> interop </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../io/IOConsole/ class=md-nav__link> <span class=md-ellipsis> io </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../logger/FileLogger/ class=md-nav__link> <span class=md-ellipsis> logger </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../messages/BaseMessage/ class=md-nav__link> <span class=md-ellipsis> messages </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../oai/oai_models/_models/BaseModel/ class=md-nav__link> <span class=md-ellipsis> oai </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../tools/BaseContext/ class=md-nav__link> <span class=md-ellipsis> tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../contributor-guide/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributor Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../faq/FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQs </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../ecosystem/agentops/ class=md-nav__link> <span class=md-ellipsis> Ecosystem </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#autogen.ChatCompletion class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ChatCompletion </span> </a> <nav class=md-nav aria-label= ChatCompletion> <ul class=md-nav__list> <li class=md-nav__item> <a href=#autogen.ChatCompletion.chat_models class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;chat_models </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.price1K class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;price1K </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.cache_seed class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cache_seed </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.cache_path class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cache_path </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.retry_wait_time class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;retry_wait_time </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.max_retry_period class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;max_retry_period </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.request_timeout class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;request_timeout </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.optimization_budget class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;optimization_budget </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.logged_history class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;logged_history </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.default_search_space class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;default_search_space </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.openai_completion_class class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;openai_completion_class </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.set_cache class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_cache </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.clear_cache class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;clear_cache </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.tune class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;tune </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.create class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.instantiate class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;instantiate </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.test class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;test </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.cost class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;cost </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.extract_text class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extract_text </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.extract_text_or_function_call class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;extract_text_or_function_call </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.print_usage_summary class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;print_usage_summary </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.start_logging class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;start_logging </span> </a> </li> <li class=md-nav__item> <a href=#autogen.ChatCompletion.stop_logging class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stop_logging </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/ag2ai/ag2/website/mkdocs/docs/docs/api-reference/autogen/ChatCompletion.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m7 14.94 6.06-6.06 2.06 2.06L9.06 17H7zM12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m4.7-10.65-1 1-2.05-2.05 1-1c.21-.22.56-.22.77 0l1.28 1.28c.22.21.22.56 0 .77M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2"/></svg> </a> <h1>ChatCompletion</h1> <div class="doc doc-object doc-class"> <h2 id=autogen.ChatCompletion class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">autogen.ChatCompletion</span> <a href=#autogen.ChatCompletion class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents first"> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title=autogen.oai.completion.Completion href=../Completion/#autogen.Completion>Completion</a></code></p> <p><code>(openai&lt;1)</code> A class for OpenAI API ChatCompletion. Share the same API as Completion.</p> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.chat_models class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">chat_models</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.chat_models class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>chat_models</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;gpt-3.5-turbo&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-3.5-turbo-0301&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-3.5-turbo-0613&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-3.5-turbo-16k&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-3.5-turbo-16k-0613&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-35-turbo&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-35-turbo-16k&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-4&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-4-32k&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-4-32k-0314&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-4-0314&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-4-0613&#39;</span><span class=p>,</span> <span class=s1>&#39;gpt-4-32k-0613&#39;</span><span class=p>}</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.price1K class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">price1K</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.price1K class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>price1K</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;text-ada-001&#39;</span><span class=p>:</span> <span class=mf>0.0004</span><span class=p>,</span> <span class=s1>&#39;text-babbage-001&#39;</span><span class=p>:</span> <span class=mf>0.0005</span><span class=p>,</span> <span class=s1>&#39;text-curie-001&#39;</span><span class=p>:</span> <span class=mf>0.002</span><span class=p>,</span> <span class=s1>&#39;code-cushman-001&#39;</span><span class=p>:</span> <span class=mf>0.024</span><span class=p>,</span> <span class=s1>&#39;code-davinci-002&#39;</span><span class=p>:</span> <span class=mf>0.1</span><span class=p>,</span> <span class=s1>&#39;text-davinci-002&#39;</span><span class=p>:</span> <span class=mf>0.02</span><span class=p>,</span> <span class=s1>&#39;text-davinci-003&#39;</span><span class=p>:</span> <span class=mf>0.02</span><span class=p>,</span> <span class=s1>&#39;gpt-3.5-turbo&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0015</span><span class=p>,</span> <span class=mf>0.002</span><span class=p>),</span> <span class=s1>&#39;gpt-3.5-turbo-instruct&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0015</span><span class=p>,</span> <span class=mf>0.002</span><span class=p>),</span> <span class=s1>&#39;gpt-3.5-turbo-0301&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0015</span><span class=p>,</span> <span class=mf>0.002</span><span class=p>),</span> <span class=s1>&#39;gpt-3.5-turbo-0613&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0015</span><span class=p>,</span> <span class=mf>0.002</span><span class=p>),</span> <span class=s1>&#39;gpt-3.5-turbo-16k&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.003</span><span class=p>,</span> <span class=mf>0.004</span><span class=p>),</span> <span class=s1>&#39;gpt-3.5-turbo-16k-0613&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.003</span><span class=p>,</span> <span class=mf>0.004</span><span class=p>),</span> <span class=s1>&#39;gpt-35-turbo&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0015</span><span class=p>,</span> <span class=mf>0.002</span><span class=p>),</span> <span class=s1>&#39;gpt-35-turbo-16k&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.003</span><span class=p>,</span> <span class=mf>0.004</span><span class=p>),</span> <span class=s1>&#39;gpt-35-turbo-instruct&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0015</span><span class=p>,</span> <span class=mf>0.002</span><span class=p>),</span> <span class=s1>&#39;gpt-4&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.06</span><span class=p>),</span> <span class=s1>&#39;gpt-4-32k&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.06</span><span class=p>,</span> <span class=mf>0.12</span><span class=p>),</span> <span class=s1>&#39;gpt-4-0314&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.06</span><span class=p>),</span> <span class=s1>&#39;gpt-4-32k-0314&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.06</span><span class=p>,</span> <span class=mf>0.12</span><span class=p>),</span> <span class=s1>&#39;gpt-4-0613&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.06</span><span class=p>),</span> <span class=s1>&#39;gpt-4-32k-0613&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.06</span><span class=p>,</span> <span class=mf>0.12</span><span class=p>)}</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.cache_seed class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">cache_seed</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.cache_seed class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>cache_seed</span> <span class=o>=</span> <span class=mi>41</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.cache_path class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">cache_path</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.cache_path class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>cache_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;.cache/</span><span class=si>{</span><span class=n><a class="autorefs autorefs-internal" title=autogen.oai.completion.Completion.cache_seed href=#autogen.ChatCompletion.cache_seed>cache_seed</a></span><span class=si>}</span><span class=s1>&#39;</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.retry_wait_time class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">retry_wait_time</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.retry_wait_time class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>retry_wait_time</span> <span class=o>=</span> <span class=mi>10</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.max_retry_period class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">max_retry_period</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.max_retry_period class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>max_retry_period</span> <span class=o>=</span> <span class=mi>120</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.request_timeout class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">request_timeout</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.request_timeout class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>request_timeout</span> <span class=o>=</span> <span class=mi>60</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.optimization_budget class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">optimization_budget</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.optimization_budget class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>optimization_budget</span> <span class=o>=</span> <span class=kc>None</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.logged_history class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">logged_history</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href=#autogen.ChatCompletion.logged_history class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>logged_history</span>
</code></pre></div> <div class="doc doc-contents "> <p>Return the book keeping dictionary.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.default_search_space class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">default_search_space</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.default_search_space class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>default_search_space</span> <span class=o>=</span> <span class=n><span title=autogen.oai.completion.Completion.default_search_space.copy>copy</span></span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id=autogen.ChatCompletion.openai_completion_class class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">openai_completion_class</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#autogen.ChatCompletion.openai_completion_class class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>openai_completion_class</span> <span class=o>=</span> <span class=ow>not</span> <span class=n><span title=autogen.oai.completion.ERROR>ERROR</span></span> <span class=ow>and</span> <span class=n><span title=openai.ChatCompletion>ChatCompletion</span></span>
</code></pre></div> <div class="doc doc-contents "> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.set_cache class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">set_cache</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.set_cache class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>set_cache</span><span class=p>(</span><span class=n>seed</span><span class=o>=</span><span class=mi>41</span><span class=p>,</span> <span class=n>cache_path_root</span><span class=o>=</span><span class=s1>&#39;.cache&#39;</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Set cache path.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>seed</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The integer identifier for the pseudo seed. Results corresponding to different seeds will be cached in different places.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>41</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>cache_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The root path for the cache. The complete cache path will be {cache_path_root}/{seed}.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> </p> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=k>def</span><span class=w> </span><span class=nf>set_cache</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>seed</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=mi>41</span><span class=p>,</span> <span class=n>cache_path_root</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;.cache&quot;</span><span class=p>):</span>
<a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Set cache path.</span>
<a id=__codelineno-0-161 name=__codelineno-0-161></a>
<a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>    Args:</span>
<a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>        seed (int, Optional): The integer identifier for the pseudo seed.</span>
<a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>            Results corresponding to different seeds will be cached in different places.</span>
<a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>        cache_path (str, Optional): The root path for the cache.</span>
<a id=__codelineno-0-166 name=__codelineno-0-166></a><span class=sd>            The complete cache path will be {cache_path_root}/{seed}.</span>
<a id=__codelineno-0-167 name=__codelineno-0-167></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-168 name=__codelineno-0-168></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>cache_seed</span> <span class=o>=</span> <span class=n>seed</span>
<a id=__codelineno-0-169 name=__codelineno-0-169></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>cache_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>cache_path_root</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>seed</span><span class=si>}</span><span class=s2>&quot;</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.clear_cache class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">clear_cache</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.clear_cache class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>clear_cache</span><span class=p>(</span><span class=n>seed</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>cache_path_root</span><span class=o>=</span><span class=s1>&#39;.cache&#39;</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Clear cache.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>seed</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The integer identifier for the pseudo seed. If omitted, all caches under cache_path_root will be cleared.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#int>int</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>cache_path</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The root path for the cache. The complete cache path will be {cache_path_root}/{seed}.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> </p> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span>
<span class=normal><a href=#__codelineno-0-184>184</a></span>
<span class=normal><a href=#__codelineno-0-185>185</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-171 name=__codelineno-0-171></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-172 name=__codelineno-0-172></a><span class=k>def</span><span class=w> </span><span class=nf>clear_cache</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>seed</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=n>cache_path_root</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;.cache&quot;</span><span class=p>):</span>
<a id=__codelineno-0-173 name=__codelineno-0-173></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Clear cache.</span>
<a id=__codelineno-0-174 name=__codelineno-0-174></a>
<a id=__codelineno-0-175 name=__codelineno-0-175></a><span class=sd>    Args:</span>
<a id=__codelineno-0-176 name=__codelineno-0-176></a><span class=sd>        seed (int, Optional): The integer identifier for the pseudo seed.</span>
<a id=__codelineno-0-177 name=__codelineno-0-177></a><span class=sd>            If omitted, all caches under cache_path_root will be cleared.</span>
<a id=__codelineno-0-178 name=__codelineno-0-178></a><span class=sd>        cache_path (str, Optional): The root path for the cache.</span>
<a id=__codelineno-0-179 name=__codelineno-0-179></a><span class=sd>            The complete cache path will be {cache_path_root}/{seed}.</span>
<a id=__codelineno-0-180 name=__codelineno-0-180></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-181 name=__codelineno-0-181></a>    <span class=k>if</span> <span class=n>seed</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-182 name=__codelineno-0-182></a>        <span class=n>shutil</span><span class=o>.</span><span class=n>rmtree</span><span class=p>(</span><span class=n>cache_path_root</span><span class=p>,</span> <span class=n>ignore_errors</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-0-183 name=__codelineno-0-183></a>        <span class=k>return</span>
<a id=__codelineno-0-184 name=__codelineno-0-184></a>    <span class=k>with</span> <span class=n>diskcache</span><span class=o>.</span><span class=n>Cache</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>cache_path_root</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>seed</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>cache</span><span class=p>:</span>
<a id=__codelineno-0-185 name=__codelineno-0-185></a>        <span class=n>cache</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.tune class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">tune</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.tune class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>tune</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>metric</span><span class=p>,</span> <span class=n>mode</span><span class=p>,</span> <span class=n>eval_func</span><span class=p>,</span> <span class=n>log_file_name</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>inference_budget</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>optimization_budget</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>num_samples</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>logging_level</span><span class=o>=</span><span class=n><a class="autorefs autorefs-external" title=logging.WARNING href=https://docs.python.org/3/library/logging.html#logging.WARNING>WARNING</a></span><span class=p>,</span> <span class=o>**</span><span class=n>config</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Tune the parameters for the OpenAI API call.</p> <p>TODO: support parallel tuning with ray or spark. TODO: support agg_method as in test</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The list of data points.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#list>list</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>metric</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The metric to optimize.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>mode</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The optimization mode, "min" or "max.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>eval_func</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The evaluation function for responses. The function should take a list of responses and a data point as input, and return a dict of metrics. For example,</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Callable href=https://docs.python.org/3/library/typing.html#typing.Callable>Callable</a></code> </span> </p> </td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>def</span><span class=w> </span><span class=nf>eval_func</span><span class=p>(</span><span class=n>responses</span><span class=p>,</span> <span class=o>**</span><span class=n>data</span><span class=p>):</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    <span class=n>solution</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;solution&quot;</span><span class=p>]</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    <span class=n>success_list</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>responses</span><span class=p>)</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>responses</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>        <span class=n>succeed</span> <span class=o>=</span> <span class=n>is_equiv_chain_of_thought</span><span class=p>(</span><span class=n>response</span><span class=p>,</span> <span class=n>solution</span><span class=p>)</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>        <span class=n>success_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>succeed</span><span class=p>)</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>    <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>        <span class=s2>&quot;expected_success&quot;</span><span class=p>:</span> <span class=mi>1</span> <span class=o>-</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=nb>sum</span><span class=p>(</span><span class=n>success_list</span><span class=p>)</span> <span class=o>/</span> <span class=n>n</span><span class=p>,</span> <span class=n>n</span><span class=p>),</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>        <span class=s2>&quot;success&quot;</span><span class=p>:</span> <span class=nb>any</span><span class=p>(</span><span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>success_list</span><span class=p>),</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>    <span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code>log_file_name (str, optional): The log file.
inference_budget (float, optional): The inference budget, dollar per instance.
optimization_budget (float, optional): The optimization budget, dollar in total.
num_samples (int, optional): The number of samples to evaluate.
    -1 means no hard restriction in the number of trials
    and the actual number is decided by optimization_budget. Defaults to 1.
logging_level (optional): logging level. Defaults to logging.WARNING.
**config (dict): The search space to update over the default search.
    For prompt, please provide a string/Callable or a list of strings/Callables.
        - If prompt is provided for chat models, it will be converted to messages under role &quot;user&quot;.
        - Do not provide both prompt and messages for chat models, but provide either of them.
        - A string template will be used to generate a prompt for each data instance
          using `prompt.format(**data)`.
        - A callable template will be used to generate a prompt for each data instance
          using `prompt(data)`.
    For stop, please provide a string, a list of strings, or a list of lists of strings.
    For messages (chat models only), please provide a list of messages (for a single chat prefix)
    or a list of lists of messages (for multiple choices of chat prefix to choose from).
    Each message should be a dict with keys &quot;role&quot; and &quot;content&quot;. The value of &quot;content&quot; can be a string/Callable template.
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>dict</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The optimized hyperparameter setting.</p> </div> </td> </tr> <tr class=doc-section-item> <td> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>tune.ExperimentAnalysis: The tuning results.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span>
<span class=normal><a href=#__codelineno-0-549>549</a></span>
<span class=normal><a href=#__codelineno-0-550>550</a></span>
<span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span>
<span class=normal><a href=#__codelineno-0-611>611</a></span>
<span class=normal><a href=#__codelineno-0-612>612</a></span>
<span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span>
<span class=normal><a href=#__codelineno-0-730>730</a></span>
<span class=normal><a href=#__codelineno-0-731>731</a></span>
<span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-536 name=__codelineno-0-536></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-537 name=__codelineno-0-537></a><span class=nd>@require_optional_import</span><span class=p>(</span><span class=s2>&quot;flaml&quot;</span><span class=p>,</span> <span class=s2>&quot;flaml&quot;</span><span class=p>)</span>
<a id=__codelineno-0-538 name=__codelineno-0-538></a><span class=k>def</span><span class=w> </span><span class=nf>tune</span><span class=p>(</span>
<a id=__codelineno-0-539 name=__codelineno-0-539></a>    <span class=bp>cls</span><span class=p>,</span>
<a id=__codelineno-0-540 name=__codelineno-0-540></a>    <span class=n>data</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span>
<a id=__codelineno-0-541 name=__codelineno-0-541></a>    <span class=n>metric</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
<a id=__codelineno-0-542 name=__codelineno-0-542></a>    <span class=n>mode</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
<a id=__codelineno-0-543 name=__codelineno-0-543></a>    <span class=n>eval_func</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span>
<a id=__codelineno-0-544 name=__codelineno-0-544></a>    <span class=n>log_file_name</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-545 name=__codelineno-0-545></a>    <span class=n>inference_budget</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-546 name=__codelineno-0-546></a>    <span class=n>optimization_budget</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>float</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-547 name=__codelineno-0-547></a>    <span class=n>num_samples</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-548 name=__codelineno-0-548></a>    <span class=n>logging_level</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>WARNING</span><span class=p>,</span>
<a id=__codelineno-0-549 name=__codelineno-0-549></a>    <span class=o>**</span><span class=n>config</span><span class=p>,</span>
<a id=__codelineno-0-550 name=__codelineno-0-550></a><span class=p>):</span>
<a id=__codelineno-0-551 name=__codelineno-0-551></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Tune the parameters for the OpenAI API call.</span>
<a id=__codelineno-0-552 name=__codelineno-0-552></a>
<a id=__codelineno-0-553 name=__codelineno-0-553></a><span class=sd>    TODO: support parallel tuning with ray or spark.</span>
<a id=__codelineno-0-554 name=__codelineno-0-554></a><span class=sd>    TODO: support agg_method as in test</span>
<a id=__codelineno-0-555 name=__codelineno-0-555></a>
<a id=__codelineno-0-556 name=__codelineno-0-556></a><span class=sd>    Args:</span>
<a id=__codelineno-0-557 name=__codelineno-0-557></a><span class=sd>        data (list): The list of data points.</span>
<a id=__codelineno-0-558 name=__codelineno-0-558></a><span class=sd>        metric (str): The metric to optimize.</span>
<a id=__codelineno-0-559 name=__codelineno-0-559></a><span class=sd>        mode (str): The optimization mode, &quot;min&quot; or &quot;max.</span>
<a id=__codelineno-0-560 name=__codelineno-0-560></a><span class=sd>        eval_func (Callable): The evaluation function for responses.</span>
<a id=__codelineno-0-561 name=__codelineno-0-561></a><span class=sd>            The function should take a list of responses and a data point as input,</span>
<a id=__codelineno-0-562 name=__codelineno-0-562></a><span class=sd>            and return a dict of metrics. For example,</span>
<a id=__codelineno-0-563 name=__codelineno-0-563></a>
<a id=__codelineno-0-564 name=__codelineno-0-564></a><span class=sd>    ```python</span>
<a id=__codelineno-0-565 name=__codelineno-0-565></a><span class=sd>    def eval_func(responses, **data):</span>
<a id=__codelineno-0-566 name=__codelineno-0-566></a><span class=sd>        solution = data[&quot;solution&quot;]</span>
<a id=__codelineno-0-567 name=__codelineno-0-567></a><span class=sd>        success_list = []</span>
<a id=__codelineno-0-568 name=__codelineno-0-568></a><span class=sd>        n = len(responses)</span>
<a id=__codelineno-0-569 name=__codelineno-0-569></a><span class=sd>        for i in range(n):</span>
<a id=__codelineno-0-570 name=__codelineno-0-570></a><span class=sd>            response = responses[i]</span>
<a id=__codelineno-0-571 name=__codelineno-0-571></a><span class=sd>            succeed = is_equiv_chain_of_thought(response, solution)</span>
<a id=__codelineno-0-572 name=__codelineno-0-572></a><span class=sd>            success_list.append(succeed)</span>
<a id=__codelineno-0-573 name=__codelineno-0-573></a><span class=sd>        return {</span>
<a id=__codelineno-0-574 name=__codelineno-0-574></a><span class=sd>            &quot;expected_success&quot;: 1 - pow(1 - sum(success_list) / n, n),</span>
<a id=__codelineno-0-575 name=__codelineno-0-575></a><span class=sd>            &quot;success&quot;: any(s for s in success_list),</span>
<a id=__codelineno-0-576 name=__codelineno-0-576></a><span class=sd>        }</span>
<a id=__codelineno-0-577 name=__codelineno-0-577></a><span class=sd>    ```</span>
<a id=__codelineno-0-578 name=__codelineno-0-578></a>
<a id=__codelineno-0-579 name=__codelineno-0-579></a><span class=sd>        log_file_name (str, optional): The log file.</span>
<a id=__codelineno-0-580 name=__codelineno-0-580></a><span class=sd>        inference_budget (float, optional): The inference budget, dollar per instance.</span>
<a id=__codelineno-0-581 name=__codelineno-0-581></a><span class=sd>        optimization_budget (float, optional): The optimization budget, dollar in total.</span>
<a id=__codelineno-0-582 name=__codelineno-0-582></a><span class=sd>        num_samples (int, optional): The number of samples to evaluate.</span>
<a id=__codelineno-0-583 name=__codelineno-0-583></a><span class=sd>            -1 means no hard restriction in the number of trials</span>
<a id=__codelineno-0-584 name=__codelineno-0-584></a><span class=sd>            and the actual number is decided by optimization_budget. Defaults to 1.</span>
<a id=__codelineno-0-585 name=__codelineno-0-585></a><span class=sd>        logging_level (optional): logging level. Defaults to logging.WARNING.</span>
<a id=__codelineno-0-586 name=__codelineno-0-586></a><span class=sd>        **config (dict): The search space to update over the default search.</span>
<a id=__codelineno-0-587 name=__codelineno-0-587></a><span class=sd>            For prompt, please provide a string/Callable or a list of strings/Callables.</span>
<a id=__codelineno-0-588 name=__codelineno-0-588></a><span class=sd>                - If prompt is provided for chat models, it will be converted to messages under role &quot;user&quot;.</span>
<a id=__codelineno-0-589 name=__codelineno-0-589></a><span class=sd>                - Do not provide both prompt and messages for chat models, but provide either of them.</span>
<a id=__codelineno-0-590 name=__codelineno-0-590></a><span class=sd>                - A string template will be used to generate a prompt for each data instance</span>
<a id=__codelineno-0-591 name=__codelineno-0-591></a><span class=sd>                  using `prompt.format(**data)`.</span>
<a id=__codelineno-0-592 name=__codelineno-0-592></a><span class=sd>                - A callable template will be used to generate a prompt for each data instance</span>
<a id=__codelineno-0-593 name=__codelineno-0-593></a><span class=sd>                  using `prompt(data)`.</span>
<a id=__codelineno-0-594 name=__codelineno-0-594></a><span class=sd>            For stop, please provide a string, a list of strings, or a list of lists of strings.</span>
<a id=__codelineno-0-595 name=__codelineno-0-595></a><span class=sd>            For messages (chat models only), please provide a list of messages (for a single chat prefix)</span>
<a id=__codelineno-0-596 name=__codelineno-0-596></a><span class=sd>            or a list of lists of messages (for multiple choices of chat prefix to choose from).</span>
<a id=__codelineno-0-597 name=__codelineno-0-597></a><span class=sd>            Each message should be a dict with keys &quot;role&quot; and &quot;content&quot;. The value of &quot;content&quot; can be a string/Callable template.</span>
<a id=__codelineno-0-598 name=__codelineno-0-598></a>
<a id=__codelineno-0-599 name=__codelineno-0-599></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-600 name=__codelineno-0-600></a><span class=sd>        dict: The optimized hyperparameter setting.</span>
<a id=__codelineno-0-601 name=__codelineno-0-601></a><span class=sd>        tune.ExperimentAnalysis: The tuning results.</span>
<a id=__codelineno-0-602 name=__codelineno-0-602></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-603 name=__codelineno-0-603></a>    <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<a id=__codelineno-0-604 name=__codelineno-0-604></a>        <span class=s2>&quot;tuning via Completion.tune is deprecated in autogen, pyautogen v0.2 and openai&gt;=1. &quot;</span>
<a id=__codelineno-0-605 name=__codelineno-0-605></a>        <span class=s2>&quot;flaml.tune supports tuning more generically.&quot;</span>
<a id=__codelineno-0-606 name=__codelineno-0-606></a>    <span class=p>)</span>
<a id=__codelineno-0-607 name=__codelineno-0-607></a>    <span class=k>if</span> <span class=n>ERROR</span><span class=p>:</span>
<a id=__codelineno-0-608 name=__codelineno-0-608></a>        <span class=k>raise</span> <span class=n>ERROR</span>
<a id=__codelineno-0-609 name=__codelineno-0-609></a>    <span class=n>space</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>default_search_space</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-610 name=__codelineno-0-610></a>    <span class=k>if</span> <span class=n>config</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-611 name=__codelineno-0-611></a>        <span class=n>space</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
<a id=__codelineno-0-612 name=__codelineno-0-612></a>        <span class=k>if</span> <span class=s2>&quot;messages&quot;</span> <span class=ow>in</span> <span class=n>space</span><span class=p>:</span>
<a id=__codelineno-0-613 name=__codelineno-0-613></a>            <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;prompt&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
<a id=__codelineno-0-614 name=__codelineno-0-614></a>        <span class=n>temperature</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;temperature&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
<a id=__codelineno-0-615 name=__codelineno-0-615></a>        <span class=n>top_p</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;top_p&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
<a id=__codelineno-0-616 name=__codelineno-0-616></a>        <span class=k>if</span> <span class=n>temperature</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>top_p</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-617 name=__codelineno-0-617></a>            <span class=n>space</span><span class=p>[</span><span class=s2>&quot;temperature_or_top_p&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=n>temperature</span><span class=p>}</span>
<a id=__codelineno-0-618 name=__codelineno-0-618></a>        <span class=k>elif</span> <span class=n>temperature</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>top_p</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-619 name=__codelineno-0-619></a>            <span class=n>space</span><span class=p>[</span><span class=s2>&quot;temperature_or_top_p&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;top_p&quot;</span><span class=p>:</span> <span class=n>top_p</span><span class=p>}</span>
<a id=__codelineno-0-620 name=__codelineno-0-620></a>        <span class=k>elif</span> <span class=n>temperature</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>top_p</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-621 name=__codelineno-0-621></a>            <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;temperature_or_top_p&quot;</span><span class=p>)</span>
<a id=__codelineno-0-622 name=__codelineno-0-622></a>            <span class=n>space</span><span class=p>[</span><span class=s2>&quot;temperature&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>temperature</span>
<a id=__codelineno-0-623 name=__codelineno-0-623></a>            <span class=n>space</span><span class=p>[</span><span class=s2>&quot;top_p&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>top_p</span>
<a id=__codelineno-0-624 name=__codelineno-0-624></a>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;temperature and top_p are not recommended to vary together.&quot;</span><span class=p>)</span>
<a id=__codelineno-0-625 name=__codelineno-0-625></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_max_valid_n_per_max_tokens</span><span class=p>,</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_min_invalid_n_per_max_tokens</span> <span class=o>=</span> <span class=p>{},</span> <span class=p>{}</span>
<a id=__codelineno-0-626 name=__codelineno-0-626></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>optimization_budget</span> <span class=o>=</span> <span class=n>optimization_budget</span>
<a id=__codelineno-0-627 name=__codelineno-0-627></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>inference_budget</span> <span class=o>=</span> <span class=n>inference_budget</span>
<a id=__codelineno-0-628 name=__codelineno-0-628></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_prune_hp</span> <span class=o>=</span> <span class=s2>&quot;best_of&quot;</span> <span class=k>if</span> <span class=n>space</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;best_of&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>1</span> <span class=k>else</span> <span class=s2>&quot;n&quot;</span>
<a id=__codelineno-0-629 name=__codelineno-0-629></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_prompts</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;prompt&quot;</span><span class=p>)</span>
<a id=__codelineno-0-630 name=__codelineno-0-630></a>    <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_prompts</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-631 name=__codelineno-0-631></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>_messages</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;messages&quot;</span><span class=p>)</span>
<a id=__codelineno-0-632 name=__codelineno-0-632></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>((</span><span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_messages</span><span class=p>,</span> <span class=nb>list</span><span class=p>),</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_messages</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=p>(</span><span class=nb>dict</span><span class=p>,</span> <span class=nb>list</span><span class=p>)))):</span>
<a id=__codelineno-0-633 name=__codelineno-0-633></a>            <span class=n>error_msg</span> <span class=o>=</span> <span class=s2>&quot;messages must be a list of dicts or a list of lists.&quot;</span>
<a id=__codelineno-0-634 name=__codelineno-0-634></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-635 name=__codelineno-0-635></a>            <span class=k>raise</span> <span class=ne>AssertionError</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-636 name=__codelineno-0-636></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_messages</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nb>dict</span><span class=p>):</span>
<a id=__codelineno-0-637 name=__codelineno-0-637></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>_messages</span> <span class=o>=</span> <span class=p>[</span><span class=bp>cls</span><span class=o>.</span><span class=n>_messages</span><span class=p>]</span>
<a id=__codelineno-0-638 name=__codelineno-0-638></a>        <span class=n>space</span><span class=p>[</span><span class=s2>&quot;messages&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>tune</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_messages</span><span class=p>))))</span>
<a id=__codelineno-0-639 name=__codelineno-0-639></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-640 name=__codelineno-0-640></a>        <span class=k>if</span> <span class=n>space</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;messages&quot;</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-641 name=__codelineno-0-641></a>            <span class=n>error_msg</span> <span class=o>=</span> <span class=s2>&quot;messages and prompt cannot be provided at the same time.&quot;</span>
<a id=__codelineno-0-642 name=__codelineno-0-642></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-643 name=__codelineno-0-643></a>            <span class=k>raise</span> <span class=ne>AssertionError</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-644 name=__codelineno-0-644></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_prompts</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
<a id=__codelineno-0-645 name=__codelineno-0-645></a>            <span class=n>error_msg</span> <span class=o>=</span> <span class=s2>&quot;prompt must be a string or a list of strings.&quot;</span>
<a id=__codelineno-0-646 name=__codelineno-0-646></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-647 name=__codelineno-0-647></a>            <span class=k>raise</span> <span class=ne>AssertionError</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-648 name=__codelineno-0-648></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_prompts</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<a id=__codelineno-0-649 name=__codelineno-0-649></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>_prompts</span> <span class=o>=</span> <span class=p>[</span><span class=bp>cls</span><span class=o>.</span><span class=n>_prompts</span><span class=p>]</span>
<a id=__codelineno-0-650 name=__codelineno-0-650></a>        <span class=n>space</span><span class=p>[</span><span class=s2>&quot;prompt&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>tune</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_prompts</span><span class=p>))))</span>
<a id=__codelineno-0-651 name=__codelineno-0-651></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;stop&quot;</span><span class=p>)</span>
<a id=__codelineno-0-652 name=__codelineno-0-652></a>    <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span><span class=p>:</span>
<a id=__codelineno-0-653 name=__codelineno-0-653></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=nb>list</span><span class=p>)):</span>
<a id=__codelineno-0-654 name=__codelineno-0-654></a>            <span class=n>error_msg</span> <span class=o>=</span> <span class=s2>&quot;stop must be a string, a list of strings, or a list of lists of strings.&quot;</span>
<a id=__codelineno-0-655 name=__codelineno-0-655></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-656 name=__codelineno-0-656></a>            <span class=k>raise</span> <span class=ne>AssertionError</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-657 name=__codelineno-0-657></a>        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>isinstance</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nb>list</span><span class=p>)):</span>
<a id=__codelineno-0-658 name=__codelineno-0-658></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span> <span class=o>=</span> <span class=p>[</span><span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span><span class=p>]</span>
<a id=__codelineno-0-659 name=__codelineno-0-659></a>        <span class=n>space</span><span class=p>[</span><span class=s2>&quot;stop&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>tune</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_stops</span><span class=p>))))</span>
<a id=__codelineno-0-660 name=__codelineno-0-660></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_config_list</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;config_list&quot;</span><span class=p>)</span>
<a id=__codelineno-0-661 name=__codelineno-0-661></a>    <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_config_list</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-662 name=__codelineno-0-662></a>        <span class=n>is_const</span> <span class=o>=</span> <span class=n>is_constant</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_config_list</span><span class=p>)</span>
<a id=__codelineno-0-663 name=__codelineno-0-663></a>        <span class=k>if</span> <span class=n>is_const</span><span class=p>:</span>
<a id=__codelineno-0-664 name=__codelineno-0-664></a>            <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;config_list&quot;</span><span class=p>)</span>
<a id=__codelineno-0-665 name=__codelineno-0-665></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_metric</span><span class=p>,</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_mode</span> <span class=o>=</span> <span class=n>metric</span><span class=p>,</span> <span class=n>mode</span>
<a id=__codelineno-0-666 name=__codelineno-0-666></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_total_cost</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># total optimization cost</span>
<a id=__codelineno-0-667 name=__codelineno-0-667></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_eval_func</span> <span class=o>=</span> <span class=n>eval_func</span>
<a id=__codelineno-0-668 name=__codelineno-0-668></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>data</span>
<a id=__codelineno-0-669 name=__codelineno-0-669></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>avg_input_tokens</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-670 name=__codelineno-0-670></a>
<a id=__codelineno-0-671 name=__codelineno-0-671></a>    <span class=n>space_model</span> <span class=o>=</span> <span class=n>space</span><span class=p>[</span><span class=s2>&quot;model&quot;</span><span class=p>]</span>
<a id=__codelineno-0-672 name=__codelineno-0-672></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>space_model</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>space_model</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-673 name=__codelineno-0-673></a>        <span class=c1># make a hierarchical search space</span>
<a id=__codelineno-0-674 name=__codelineno-0-674></a>        <span class=n>subspace</span> <span class=o>=</span> <span class=p>{}</span>
<a id=__codelineno-0-675 name=__codelineno-0-675></a>        <span class=k>if</span> <span class=s2>&quot;max_tokens&quot;</span> <span class=ow>in</span> <span class=n>space</span><span class=p>:</span>
<a id=__codelineno-0-676 name=__codelineno-0-676></a>            <span class=n>subspace</span><span class=p>[</span><span class=s2>&quot;max_tokens&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;max_tokens&quot;</span><span class=p>)</span>
<a id=__codelineno-0-677 name=__codelineno-0-677></a>        <span class=k>if</span> <span class=s2>&quot;temperature_or_top_p&quot;</span> <span class=ow>in</span> <span class=n>space</span><span class=p>:</span>
<a id=__codelineno-0-678 name=__codelineno-0-678></a>            <span class=n>subspace</span><span class=p>[</span><span class=s2>&quot;temperature_or_top_p&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;temperature_or_top_p&quot;</span><span class=p>)</span>
<a id=__codelineno-0-679 name=__codelineno-0-679></a>        <span class=k>if</span> <span class=s2>&quot;best_of&quot;</span> <span class=ow>in</span> <span class=n>space</span><span class=p>:</span>
<a id=__codelineno-0-680 name=__codelineno-0-680></a>            <span class=n>subspace</span><span class=p>[</span><span class=s2>&quot;best_of&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;best_of&quot;</span><span class=p>)</span>
<a id=__codelineno-0-681 name=__codelineno-0-681></a>        <span class=k>if</span> <span class=s2>&quot;n&quot;</span> <span class=ow>in</span> <span class=n>space</span><span class=p>:</span>
<a id=__codelineno-0-682 name=__codelineno-0-682></a>            <span class=n>subspace</span><span class=p>[</span><span class=s2>&quot;n&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;n&quot;</span><span class=p>)</span>
<a id=__codelineno-0-683 name=__codelineno-0-683></a>        <span class=n>choices</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-684 name=__codelineno-0-684></a>        <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>space</span><span class=p>[</span><span class=s2>&quot;model&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-685 name=__codelineno-0-685></a>            <span class=n>choices</span><span class=o>.</span><span class=n>append</span><span class=p>({</span><span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=n>model</span><span class=p>,</span> <span class=o>**</span><span class=n>subspace</span><span class=p>})</span>
<a id=__codelineno-0-686 name=__codelineno-0-686></a>        <span class=n>space</span><span class=p>[</span><span class=s2>&quot;subspace&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>tune</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>choices</span><span class=p>)</span>
<a id=__codelineno-0-687 name=__codelineno-0-687></a>        <span class=n>space</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;model&quot;</span><span class=p>)</span>
<a id=__codelineno-0-688 name=__codelineno-0-688></a>        <span class=c1># start all the models with the same hp config</span>
<a id=__codelineno-0-689 name=__codelineno-0-689></a>        <span class=n>search_alg</span> <span class=o>=</span> <span class=n>BlendSearch</span><span class=p>(</span>
<a id=__codelineno-0-690 name=__codelineno-0-690></a>            <span class=n>cost_attr</span><span class=o>=</span><span class=s2>&quot;cost&quot;</span><span class=p>,</span>
<a id=__codelineno-0-691 name=__codelineno-0-691></a>            <span class=n>cost_budget</span><span class=o>=</span><span class=n>optimization_budget</span><span class=p>,</span>
<a id=__codelineno-0-692 name=__codelineno-0-692></a>            <span class=n>metric</span><span class=o>=</span><span class=n>metric</span><span class=p>,</span>
<a id=__codelineno-0-693 name=__codelineno-0-693></a>            <span class=n>mode</span><span class=o>=</span><span class=n>mode</span><span class=p>,</span>
<a id=__codelineno-0-694 name=__codelineno-0-694></a>            <span class=n>space</span><span class=o>=</span><span class=n>space</span><span class=p>,</span>
<a id=__codelineno-0-695 name=__codelineno-0-695></a>        <span class=p>)</span>
<a id=__codelineno-0-696 name=__codelineno-0-696></a>        <span class=n>config0</span> <span class=o>=</span> <span class=n>search_alg</span><span class=o>.</span><span class=n>suggest</span><span class=p>(</span><span class=s2>&quot;t0&quot;</span><span class=p>)</span>
<a id=__codelineno-0-697 name=__codelineno-0-697></a>        <span class=n>points_to_evaluate</span> <span class=o>=</span> <span class=p>[</span><span class=n>config0</span><span class=p>]</span>
<a id=__codelineno-0-698 name=__codelineno-0-698></a>        <span class=k>for</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>space_model</span><span class=p>:</span>
<a id=__codelineno-0-699 name=__codelineno-0-699></a>            <span class=k>if</span> <span class=n>model</span> <span class=o>!=</span> <span class=n>config0</span><span class=p>[</span><span class=s2>&quot;subspace&quot;</span><span class=p>][</span><span class=s2>&quot;model&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-700 name=__codelineno-0-700></a>                <span class=n>point</span> <span class=o>=</span> <span class=n>config0</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-701 name=__codelineno-0-701></a>                <span class=n>point</span><span class=p>[</span><span class=s2>&quot;subspace&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>point</span><span class=p>[</span><span class=s2>&quot;subspace&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-702 name=__codelineno-0-702></a>                <span class=n>point</span><span class=p>[</span><span class=s2>&quot;subspace&quot;</span><span class=p>][</span><span class=s2>&quot;model&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>model</span>
<a id=__codelineno-0-703 name=__codelineno-0-703></a>                <span class=n>points_to_evaluate</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>point</span><span class=p>)</span>
<a id=__codelineno-0-704 name=__codelineno-0-704></a>        <span class=n>search_alg</span> <span class=o>=</span> <span class=n>BlendSearch</span><span class=p>(</span>
<a id=__codelineno-0-705 name=__codelineno-0-705></a>            <span class=n>cost_attr</span><span class=o>=</span><span class=s2>&quot;cost&quot;</span><span class=p>,</span>
<a id=__codelineno-0-706 name=__codelineno-0-706></a>            <span class=n>cost_budget</span><span class=o>=</span><span class=n>optimization_budget</span><span class=p>,</span>
<a id=__codelineno-0-707 name=__codelineno-0-707></a>            <span class=n>metric</span><span class=o>=</span><span class=n>metric</span><span class=p>,</span>
<a id=__codelineno-0-708 name=__codelineno-0-708></a>            <span class=n>mode</span><span class=o>=</span><span class=n>mode</span><span class=p>,</span>
<a id=__codelineno-0-709 name=__codelineno-0-709></a>            <span class=n>space</span><span class=o>=</span><span class=n>space</span><span class=p>,</span>
<a id=__codelineno-0-710 name=__codelineno-0-710></a>            <span class=n>points_to_evaluate</span><span class=o>=</span><span class=n>points_to_evaluate</span><span class=p>,</span>
<a id=__codelineno-0-711 name=__codelineno-0-711></a>        <span class=p>)</span>
<a id=__codelineno-0-712 name=__codelineno-0-712></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-713 name=__codelineno-0-713></a>        <span class=n>search_alg</span> <span class=o>=</span> <span class=n>BlendSearch</span><span class=p>(</span>
<a id=__codelineno-0-714 name=__codelineno-0-714></a>            <span class=n>cost_attr</span><span class=o>=</span><span class=s2>&quot;cost&quot;</span><span class=p>,</span>
<a id=__codelineno-0-715 name=__codelineno-0-715></a>            <span class=n>cost_budget</span><span class=o>=</span><span class=n>optimization_budget</span><span class=p>,</span>
<a id=__codelineno-0-716 name=__codelineno-0-716></a>            <span class=n>metric</span><span class=o>=</span><span class=n>metric</span><span class=p>,</span>
<a id=__codelineno-0-717 name=__codelineno-0-717></a>            <span class=n>mode</span><span class=o>=</span><span class=n>mode</span><span class=p>,</span>
<a id=__codelineno-0-718 name=__codelineno-0-718></a>            <span class=n>space</span><span class=o>=</span><span class=n>space</span><span class=p>,</span>
<a id=__codelineno-0-719 name=__codelineno-0-719></a>        <span class=p>)</span>
<a id=__codelineno-0-720 name=__codelineno-0-720></a>    <span class=n>old_level</span> <span class=o>=</span> <span class=n>logger</span><span class=o>.</span><span class=n>getEffectiveLevel</span><span class=p>()</span>
<a id=__codelineno-0-721 name=__codelineno-0-721></a>    <span class=n>logger</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>logging_level</span><span class=p>)</span>
<a id=__codelineno-0-722 name=__codelineno-0-722></a>    <span class=k>with</span> <span class=n>diskcache</span><span class=o>.</span><span class=n>Cache</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>cache_path</span><span class=p>)</span> <span class=k>as</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_cache</span><span class=p>:</span>
<a id=__codelineno-0-723 name=__codelineno-0-723></a>        <span class=n>analysis</span> <span class=o>=</span> <span class=n>tune</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
<a id=__codelineno-0-724 name=__codelineno-0-724></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>_eval</span><span class=p>,</span>
<a id=__codelineno-0-725 name=__codelineno-0-725></a>            <span class=n>search_alg</span><span class=o>=</span><span class=n>search_alg</span><span class=p>,</span>
<a id=__codelineno-0-726 name=__codelineno-0-726></a>            <span class=n>num_samples</span><span class=o>=</span><span class=n>num_samples</span><span class=p>,</span>
<a id=__codelineno-0-727 name=__codelineno-0-727></a>            <span class=n>log_file_name</span><span class=o>=</span><span class=n>log_file_name</span><span class=p>,</span>
<a id=__codelineno-0-728 name=__codelineno-0-728></a>            <span class=n>verbose</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-0-729 name=__codelineno-0-729></a>        <span class=p>)</span>
<a id=__codelineno-0-730 name=__codelineno-0-730></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>analysis</span><span class=o>.</span><span class=n>best_config</span>
<a id=__codelineno-0-731 name=__codelineno-0-731></a>    <span class=n>params</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_get_params_for_create</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
<a id=__codelineno-0-732 name=__codelineno-0-732></a>    <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_config_list</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>is_const</span><span class=p>:</span>
<a id=__codelineno-0-733 name=__codelineno-0-733></a>        <span class=n>params</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;config_list&quot;</span><span class=p>)</span>
<a id=__codelineno-0-734 name=__codelineno-0-734></a>    <span class=n>logger</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>old_level</span><span class=p>)</span>
<a id=__codelineno-0-735 name=__codelineno-0-735></a>    <span class=k>return</span> <span class=n>params</span><span class=p>,</span> <span class=n>analysis</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.create class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">create</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.create class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>create</span><span class=p>(</span><span class=n>context</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>use_cache</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>config_list</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>filter_func</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>raise_on_ratelimit_or_timeout</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>allow_format_str_template</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>config</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Make a completion for a given context.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>context</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The context to instantiate the prompt. It needs to contain keys that are used by the prompt template or the filter function. E.g., <code>prompt="Complete the following sentence: {prefix}, context={"prefix": "Today I feel"}</code>. The actual prompt will be: "Complete the following sentence: Today I feel".</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<span title=Dict>Dict</span>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>use_cache</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Whether to use cached responses.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>config_list</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>List of configurations for the completion to try. The first one that does not raise an error will be used. Only the differences from the default config need to be provided. E.g.,</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>oai</span><span class=o>.</span><span class=n>Completion</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>        <span class=n>config_list</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>            <span class=p>{</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>                <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-4&quot;</span><span class=p>,</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>                <span class=s2>&quot;api_key&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;AZURE_OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>                <span class=s2>&quot;api_type&quot;</span><span class=p>:</span> <span class=s2>&quot;azure&quot;</span><span class=p>,</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>                <span class=s2>&quot;base_url&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;AZURE_OPENAI_API_BASE&quot;</span><span class=p>),</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>                <span class=s2>&quot;api_version&quot;</span><span class=p>:</span> <span class=s2>&quot;2024-02-01&quot;</span><span class=p>,</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>            <span class=p>},</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>            <span class=p>{</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>                <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;gpt-3.5-turbo&quot;</span><span class=p>,</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>                <span class=s2>&quot;api_key&quot;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>                <span class=s2>&quot;base_url&quot;</span><span class=p>:</span> <span class=s2>&quot;https://api.openai.com/v1&quot;</span><span class=p>,</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>            <span class=p>},</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>            <span class=p>{</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>                <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=s2>&quot;llama-7B&quot;</span><span class=p>,</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>                <span class=s2>&quot;base_url&quot;</span><span class=p>:</span> <span class=s2>&quot;http://127.0.0.1:8080&quot;</span><span class=p>,</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>            <span class=p>},</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>        <span class=p>],</span>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>        <span class=n>prompt</span><span class=o>=</span><span class=s2>&quot;Hi&quot;</span><span class=p>,</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>    <span class=p>)</span>
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<span title=List>List</span>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>filter_func</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>A function that takes in the context and the response and returns a boolean to indicate whether the response is valid. E.g.,</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>    <span class=k>def</span><span class=w> </span><span class=nf>yes_or_no_filter</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>config</span><span class=p>,</span> <span class=n>response</span><span class=p>):</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>        <span class=k>return</span> <span class=n>context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;yes_or_no_choice&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span> <span class=ow>is</span> <span class=kc>False</span> <span class=ow>or</span> <span class=nb>any</span><span class=p>(</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>            <span class=n>text</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;Yes.&quot;</span><span class=p>,</span> <span class=s2>&quot;No.&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>text</span> <span class=ow>in</span> <span class=n>oai</span><span class=o>.</span><span class=n>Completion</span><span class=o>.</span><span class=n>extract_text</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>        <span class=p>)</span>
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" title=typing.Callable href=https://docs.python.org/3/library/typing.html#typing.Callable>Callable</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>raise_on_ratelimit_or_timeout</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Whether to raise RateLimitError or Timeout when all configs fail. When set to False, -1 will be returned when all configs fail.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>allow_format_str_template</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Whether to allow format string template in the config.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a>, <a class="autorefs autorefs-external" title=typing.Optional href=https://docs.python.org/3/library/typing.html#typing.Optional>Optional</a>)</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>**config</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Configuration for the openai API call. This is used as parameters for calling openai API. The "prompt" or "messages" parameter can contain a template (str or Callable) which will be instantiated with the context. Besides the parameters for the openai API call, it can also contain: - <code>max_retry_period</code> (int): the total time (in seconds) allowed for retrying failed requests. - <code>retry_wait_time</code> (int): the time interval to wait (in seconds) before retrying a failed request. - <code>cache_seed</code> (int) for the cache. This is useful when implementing "controlled randomness" for the completion.</p> </div> <p> <span class=doc-param-default> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Responses from OpenAI API, with additional fields. - <code>cost</code>: the total cost.</p> </div> </td> </tr> <tr class=doc-section-item> <td> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>When <code>config_list</code> is provided, the response will contain a few more fields: - <code>config_id</code>: the index of the config in the config_list that is used to generate the response. - <code>pass_filter</code>: whether the response passes the filter function. None if no filter is provided.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span>
<span class=normal><a href=#__codelineno-0-762>762</a></span>
<span class=normal><a href=#__codelineno-0-763>763</a></span>
<span class=normal><a href=#__codelineno-0-764>764</a></span>
<span class=normal><a href=#__codelineno-0-765>765</a></span>
<span class=normal><a href=#__codelineno-0-766>766</a></span>
<span class=normal><a href=#__codelineno-0-767>767</a></span>
<span class=normal><a href=#__codelineno-0-768>768</a></span>
<span class=normal><a href=#__codelineno-0-769>769</a></span>
<span class=normal><a href=#__codelineno-0-770>770</a></span>
<span class=normal><a href=#__codelineno-0-771>771</a></span>
<span class=normal><a href=#__codelineno-0-772>772</a></span>
<span class=normal><a href=#__codelineno-0-773>773</a></span>
<span class=normal><a href=#__codelineno-0-774>774</a></span>
<span class=normal><a href=#__codelineno-0-775>775</a></span>
<span class=normal><a href=#__codelineno-0-776>776</a></span>
<span class=normal><a href=#__codelineno-0-777>777</a></span>
<span class=normal><a href=#__codelineno-0-778>778</a></span>
<span class=normal><a href=#__codelineno-0-779>779</a></span>
<span class=normal><a href=#__codelineno-0-780>780</a></span>
<span class=normal><a href=#__codelineno-0-781>781</a></span>
<span class=normal><a href=#__codelineno-0-782>782</a></span>
<span class=normal><a href=#__codelineno-0-783>783</a></span>
<span class=normal><a href=#__codelineno-0-784>784</a></span>
<span class=normal><a href=#__codelineno-0-785>785</a></span>
<span class=normal><a href=#__codelineno-0-786>786</a></span>
<span class=normal><a href=#__codelineno-0-787>787</a></span>
<span class=normal><a href=#__codelineno-0-788>788</a></span>
<span class=normal><a href=#__codelineno-0-789>789</a></span>
<span class=normal><a href=#__codelineno-0-790>790</a></span>
<span class=normal><a href=#__codelineno-0-791>791</a></span>
<span class=normal><a href=#__codelineno-0-792>792</a></span>
<span class=normal><a href=#__codelineno-0-793>793</a></span>
<span class=normal><a href=#__codelineno-0-794>794</a></span>
<span class=normal><a href=#__codelineno-0-795>795</a></span>
<span class=normal><a href=#__codelineno-0-796>796</a></span>
<span class=normal><a href=#__codelineno-0-797>797</a></span>
<span class=normal><a href=#__codelineno-0-798>798</a></span>
<span class=normal><a href=#__codelineno-0-799>799</a></span>
<span class=normal><a href=#__codelineno-0-800>800</a></span>
<span class=normal><a href=#__codelineno-0-801>801</a></span>
<span class=normal><a href=#__codelineno-0-802>802</a></span>
<span class=normal><a href=#__codelineno-0-803>803</a></span>
<span class=normal><a href=#__codelineno-0-804>804</a></span>
<span class=normal><a href=#__codelineno-0-805>805</a></span>
<span class=normal><a href=#__codelineno-0-806>806</a></span>
<span class=normal><a href=#__codelineno-0-807>807</a></span>
<span class=normal><a href=#__codelineno-0-808>808</a></span>
<span class=normal><a href=#__codelineno-0-809>809</a></span>
<span class=normal><a href=#__codelineno-0-810>810</a></span>
<span class=normal><a href=#__codelineno-0-811>811</a></span>
<span class=normal><a href=#__codelineno-0-812>812</a></span>
<span class=normal><a href=#__codelineno-0-813>813</a></span>
<span class=normal><a href=#__codelineno-0-814>814</a></span>
<span class=normal><a href=#__codelineno-0-815>815</a></span>
<span class=normal><a href=#__codelineno-0-816>816</a></span>
<span class=normal><a href=#__codelineno-0-817>817</a></span>
<span class=normal><a href=#__codelineno-0-818>818</a></span>
<span class=normal><a href=#__codelineno-0-819>819</a></span>
<span class=normal><a href=#__codelineno-0-820>820</a></span>
<span class=normal><a href=#__codelineno-0-821>821</a></span>
<span class=normal><a href=#__codelineno-0-822>822</a></span>
<span class=normal><a href=#__codelineno-0-823>823</a></span>
<span class=normal><a href=#__codelineno-0-824>824</a></span>
<span class=normal><a href=#__codelineno-0-825>825</a></span>
<span class=normal><a href=#__codelineno-0-826>826</a></span>
<span class=normal><a href=#__codelineno-0-827>827</a></span>
<span class=normal><a href=#__codelineno-0-828>828</a></span>
<span class=normal><a href=#__codelineno-0-829>829</a></span>
<span class=normal><a href=#__codelineno-0-830>830</a></span>
<span class=normal><a href=#__codelineno-0-831>831</a></span>
<span class=normal><a href=#__codelineno-0-832>832</a></span>
<span class=normal><a href=#__codelineno-0-833>833</a></span>
<span class=normal><a href=#__codelineno-0-834>834</a></span>
<span class=normal><a href=#__codelineno-0-835>835</a></span>
<span class=normal><a href=#__codelineno-0-836>836</a></span>
<span class=normal><a href=#__codelineno-0-837>837</a></span>
<span class=normal><a href=#__codelineno-0-838>838</a></span>
<span class=normal><a href=#__codelineno-0-839>839</a></span>
<span class=normal><a href=#__codelineno-0-840>840</a></span>
<span class=normal><a href=#__codelineno-0-841>841</a></span>
<span class=normal><a href=#__codelineno-0-842>842</a></span>
<span class=normal><a href=#__codelineno-0-843>843</a></span>
<span class=normal><a href=#__codelineno-0-844>844</a></span>
<span class=normal><a href=#__codelineno-0-845>845</a></span>
<span class=normal><a href=#__codelineno-0-846>846</a></span>
<span class=normal><a href=#__codelineno-0-847>847</a></span>
<span class=normal><a href=#__codelineno-0-848>848</a></span>
<span class=normal><a href=#__codelineno-0-849>849</a></span>
<span class=normal><a href=#__codelineno-0-850>850</a></span>
<span class=normal><a href=#__codelineno-0-851>851</a></span>
<span class=normal><a href=#__codelineno-0-852>852</a></span>
<span class=normal><a href=#__codelineno-0-853>853</a></span>
<span class=normal><a href=#__codelineno-0-854>854</a></span>
<span class=normal><a href=#__codelineno-0-855>855</a></span>
<span class=normal><a href=#__codelineno-0-856>856</a></span>
<span class=normal><a href=#__codelineno-0-857>857</a></span>
<span class=normal><a href=#__codelineno-0-858>858</a></span>
<span class=normal><a href=#__codelineno-0-859>859</a></span>
<span class=normal><a href=#__codelineno-0-860>860</a></span>
<span class=normal><a href=#__codelineno-0-861>861</a></span>
<span class=normal><a href=#__codelineno-0-862>862</a></span>
<span class=normal><a href=#__codelineno-0-863>863</a></span>
<span class=normal><a href=#__codelineno-0-864>864</a></span>
<span class=normal><a href=#__codelineno-0-865>865</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-737 name=__codelineno-0-737></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-738 name=__codelineno-0-738></a><span class=k>def</span><span class=w> </span><span class=nf>create</span><span class=p>(</span>
<a id=__codelineno-0-739 name=__codelineno-0-739></a>    <span class=bp>cls</span><span class=p>,</span>
<a id=__codelineno-0-740 name=__codelineno-0-740></a>    <span class=n>context</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-741 name=__codelineno-0-741></a>    <span class=n>use_cache</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-742 name=__codelineno-0-742></a>    <span class=n>config_list</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-743 name=__codelineno-0-743></a>    <span class=n>filter_func</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Callable</span><span class=p>[[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]],</span> <span class=nb>bool</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-744 name=__codelineno-0-744></a>    <span class=n>raise_on_ratelimit_or_timeout</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-745 name=__codelineno-0-745></a>    <span class=n>allow_format_str_template</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-746 name=__codelineno-0-746></a>    <span class=o>**</span><span class=n>config</span><span class=p>,</span>
<a id=__codelineno-0-747 name=__codelineno-0-747></a><span class=p>):</span>
<a id=__codelineno-0-748 name=__codelineno-0-748></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Make a completion for a given context.</span>
<a id=__codelineno-0-749 name=__codelineno-0-749></a>
<a id=__codelineno-0-750 name=__codelineno-0-750></a><span class=sd>    Args:</span>
<a id=__codelineno-0-751 name=__codelineno-0-751></a><span class=sd>        context (Dict, Optional): The context to instantiate the prompt.</span>
<a id=__codelineno-0-752 name=__codelineno-0-752></a><span class=sd>            It needs to contain keys that are used by the prompt template or the filter function.</span>
<a id=__codelineno-0-753 name=__codelineno-0-753></a><span class=sd>            E.g., `prompt=&quot;Complete the following sentence: {prefix}, context={&quot;prefix&quot;: &quot;Today I feel&quot;}`.</span>
<a id=__codelineno-0-754 name=__codelineno-0-754></a><span class=sd>            The actual prompt will be:</span>
<a id=__codelineno-0-755 name=__codelineno-0-755></a><span class=sd>            &quot;Complete the following sentence: Today I feel&quot;.</span>
<a id=__codelineno-0-756 name=__codelineno-0-756></a><span class=sd>        use_cache (bool, Optional): Whether to use cached responses.</span>
<a id=__codelineno-0-757 name=__codelineno-0-757></a><span class=sd>        config_list (List, Optional): List of configurations for the completion to try.</span>
<a id=__codelineno-0-758 name=__codelineno-0-758></a><span class=sd>            The first one that does not raise an error will be used.</span>
<a id=__codelineno-0-759 name=__codelineno-0-759></a><span class=sd>            Only the differences from the default config need to be provided.</span>
<a id=__codelineno-0-760 name=__codelineno-0-760></a><span class=sd>            E.g.,</span>
<a id=__codelineno-0-761 name=__codelineno-0-761></a>
<a id=__codelineno-0-762 name=__codelineno-0-762></a><span class=sd>            ```python</span>
<a id=__codelineno-0-763 name=__codelineno-0-763></a><span class=sd>                response = oai.Completion.create(</span>
<a id=__codelineno-0-764 name=__codelineno-0-764></a><span class=sd>                    config_list = [</span>
<a id=__codelineno-0-765 name=__codelineno-0-765></a><span class=sd>                        {</span>
<a id=__codelineno-0-766 name=__codelineno-0-766></a><span class=sd>                            &quot;model&quot;: &quot;gpt-4&quot;,</span>
<a id=__codelineno-0-767 name=__codelineno-0-767></a><span class=sd>                            &quot;api_key&quot;: os.environ.get(&quot;AZURE_OPENAI_API_KEY&quot;),</span>
<a id=__codelineno-0-768 name=__codelineno-0-768></a><span class=sd>                            &quot;api_type&quot;: &quot;azure&quot;,</span>
<a id=__codelineno-0-769 name=__codelineno-0-769></a><span class=sd>                            &quot;base_url&quot;: os.environ.get(&quot;AZURE_OPENAI_API_BASE&quot;),</span>
<a id=__codelineno-0-770 name=__codelineno-0-770></a><span class=sd>                            &quot;api_version&quot;: &quot;2024-02-01&quot;,</span>
<a id=__codelineno-0-771 name=__codelineno-0-771></a><span class=sd>                        },</span>
<a id=__codelineno-0-772 name=__codelineno-0-772></a><span class=sd>                        {</span>
<a id=__codelineno-0-773 name=__codelineno-0-773></a><span class=sd>                            &quot;model&quot;: &quot;gpt-3.5-turbo&quot;,</span>
<a id=__codelineno-0-774 name=__codelineno-0-774></a><span class=sd>                            &quot;api_key&quot;: os.environ.get(&quot;OPENAI_API_KEY&quot;),</span>
<a id=__codelineno-0-775 name=__codelineno-0-775></a><span class=sd>                            &quot;base_url&quot;: &quot;https://api.openai.com/v1&quot;,</span>
<a id=__codelineno-0-776 name=__codelineno-0-776></a><span class=sd>                        },</span>
<a id=__codelineno-0-777 name=__codelineno-0-777></a><span class=sd>                        {</span>
<a id=__codelineno-0-778 name=__codelineno-0-778></a><span class=sd>                            &quot;model&quot;: &quot;llama-7B&quot;,</span>
<a id=__codelineno-0-779 name=__codelineno-0-779></a><span class=sd>                            &quot;base_url&quot;: &quot;http://127.0.0.1:8080&quot;,</span>
<a id=__codelineno-0-780 name=__codelineno-0-780></a><span class=sd>                        },</span>
<a id=__codelineno-0-781 name=__codelineno-0-781></a><span class=sd>                    ],</span>
<a id=__codelineno-0-782 name=__codelineno-0-782></a><span class=sd>                    prompt=&quot;Hi&quot;,</span>
<a id=__codelineno-0-783 name=__codelineno-0-783></a><span class=sd>                )</span>
<a id=__codelineno-0-784 name=__codelineno-0-784></a><span class=sd>            ```</span>
<a id=__codelineno-0-785 name=__codelineno-0-785></a>
<a id=__codelineno-0-786 name=__codelineno-0-786></a><span class=sd>        filter_func (Callable, Optional): A function that takes in the context and the response and returns a boolean to indicate whether the response is valid. E.g.,</span>
<a id=__codelineno-0-787 name=__codelineno-0-787></a>
<a id=__codelineno-0-788 name=__codelineno-0-788></a><span class=sd>            ```python</span>
<a id=__codelineno-0-789 name=__codelineno-0-789></a><span class=sd>                def yes_or_no_filter(context, config, response):</span>
<a id=__codelineno-0-790 name=__codelineno-0-790></a><span class=sd>                    return context.get(&quot;yes_or_no_choice&quot;, False) is False or any(</span>
<a id=__codelineno-0-791 name=__codelineno-0-791></a><span class=sd>                        text in [&quot;Yes.&quot;, &quot;No.&quot;] for text in oai.Completion.extract_text(response)</span>
<a id=__codelineno-0-792 name=__codelineno-0-792></a><span class=sd>                    )</span>
<a id=__codelineno-0-793 name=__codelineno-0-793></a><span class=sd>            ```</span>
<a id=__codelineno-0-794 name=__codelineno-0-794></a>
<a id=__codelineno-0-795 name=__codelineno-0-795></a><span class=sd>        raise_on_ratelimit_or_timeout (bool, Optional): Whether to raise RateLimitError or Timeout when all configs fail.</span>
<a id=__codelineno-0-796 name=__codelineno-0-796></a><span class=sd>            When set to False, -1 will be returned when all configs fail.</span>
<a id=__codelineno-0-797 name=__codelineno-0-797></a><span class=sd>        allow_format_str_template (bool, Optional): Whether to allow format string template in the config.</span>
<a id=__codelineno-0-798 name=__codelineno-0-798></a><span class=sd>        **config: Configuration for the openai API call. This is used as parameters for calling openai API.</span>
<a id=__codelineno-0-799 name=__codelineno-0-799></a><span class=sd>            The &quot;prompt&quot; or &quot;messages&quot; parameter can contain a template (str or Callable) which will be instantiated with the context.</span>
<a id=__codelineno-0-800 name=__codelineno-0-800></a><span class=sd>            Besides the parameters for the openai API call, it can also contain:</span>
<a id=__codelineno-0-801 name=__codelineno-0-801></a><span class=sd>            - `max_retry_period` (int): the total time (in seconds) allowed for retrying failed requests.</span>
<a id=__codelineno-0-802 name=__codelineno-0-802></a><span class=sd>            - `retry_wait_time` (int): the time interval to wait (in seconds) before retrying a failed request.</span>
<a id=__codelineno-0-803 name=__codelineno-0-803></a><span class=sd>            - `cache_seed` (int) for the cache. This is useful when implementing &quot;controlled randomness&quot; for the completion.</span>
<a id=__codelineno-0-804 name=__codelineno-0-804></a>
<a id=__codelineno-0-805 name=__codelineno-0-805></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-806 name=__codelineno-0-806></a><span class=sd>        Responses from OpenAI API, with additional fields.</span>
<a id=__codelineno-0-807 name=__codelineno-0-807></a><span class=sd>            - `cost`: the total cost.</span>
<a id=__codelineno-0-808 name=__codelineno-0-808></a><span class=sd>        When `config_list` is provided, the response will contain a few more fields:</span>
<a id=__codelineno-0-809 name=__codelineno-0-809></a><span class=sd>            - `config_id`: the index of the config in the config_list that is used to generate the response.</span>
<a id=__codelineno-0-810 name=__codelineno-0-810></a><span class=sd>            - `pass_filter`: whether the response passes the filter function. None if no filter is provided.</span>
<a id=__codelineno-0-811 name=__codelineno-0-811></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-812 name=__codelineno-0-812></a>    <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<a id=__codelineno-0-813 name=__codelineno-0-813></a>        <span class=s2>&quot;Completion.create is deprecated in autogen, pyautogen v0.2 and openai&gt;=1. &quot;</span>
<a id=__codelineno-0-814 name=__codelineno-0-814></a>        <span class=s2>&quot;The new openai requires initiating a client for inference. &quot;</span>
<a id=__codelineno-0-815 name=__codelineno-0-815></a>    <span class=p>)</span>
<a id=__codelineno-0-816 name=__codelineno-0-816></a>    <span class=k>if</span> <span class=n>ERROR</span><span class=p>:</span>
<a id=__codelineno-0-817 name=__codelineno-0-817></a>        <span class=k>raise</span> <span class=n>ERROR</span>
<a id=__codelineno-0-818 name=__codelineno-0-818></a>
<a id=__codelineno-0-819 name=__codelineno-0-819></a>    <span class=c1># Warn if a config list was provided but was empty</span>
<a id=__codelineno-0-820 name=__codelineno-0-820></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>config_list</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>config_list</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-821 name=__codelineno-0-821></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<a id=__codelineno-0-822 name=__codelineno-0-822></a>            <span class=s2>&quot;Completion was provided with a config_list, but the list was empty. Adopting default OpenAI behavior, which reads from the &#39;model&#39; parameter instead.&quot;</span>
<a id=__codelineno-0-823 name=__codelineno-0-823></a>        <span class=p>)</span>
<a id=__codelineno-0-824 name=__codelineno-0-824></a>
<a id=__codelineno-0-825 name=__codelineno-0-825></a>    <span class=k>if</span> <span class=n>config_list</span><span class=p>:</span>
<a id=__codelineno-0-826 name=__codelineno-0-826></a>        <span class=n>last</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>config_list</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
<a id=__codelineno-0-827 name=__codelineno-0-827></a>        <span class=n>cost</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-828 name=__codelineno-0-828></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>each_config</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>config_list</span><span class=p>):</span>
<a id=__codelineno-0-829 name=__codelineno-0-829></a>            <span class=n>base_config</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-0-830 name=__codelineno-0-830></a>            <span class=n>base_config</span><span class=p>[</span><span class=s2>&quot;allow_format_str_template&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>allow_format_str_template</span>
<a id=__codelineno-0-831 name=__codelineno-0-831></a>            <span class=n>base_config</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>each_config</span><span class=p>)</span>
<a id=__codelineno-0-832 name=__codelineno-0-832></a>            <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>last</span> <span class=ow>and</span> <span class=n>filter_func</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=s2>&quot;max_retry_period&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>base_config</span><span class=p>:</span>
<a id=__codelineno-0-833 name=__codelineno-0-833></a>                <span class=c1># max_retry_period = 0 to avoid retrying when no filter is given</span>
<a id=__codelineno-0-834 name=__codelineno-0-834></a>                <span class=n>base_config</span><span class=p>[</span><span class=s2>&quot;max_retry_period&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-835 name=__codelineno-0-835></a>            <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-836 name=__codelineno-0-836></a>                <span class=n>response</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
<a id=__codelineno-0-837 name=__codelineno-0-837></a>                    <span class=n>context</span><span class=p>,</span>
<a id=__codelineno-0-838 name=__codelineno-0-838></a>                    <span class=n>use_cache</span><span class=p>,</span>
<a id=__codelineno-0-839 name=__codelineno-0-839></a>                    <span class=n>raise_on_ratelimit_or_timeout</span><span class=o>=</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>last</span> <span class=ow>or</span> <span class=n>raise_on_ratelimit_or_timeout</span><span class=p>,</span>
<a id=__codelineno-0-840 name=__codelineno-0-840></a>                    <span class=o>**</span><span class=n>base_config</span><span class=p>,</span>
<a id=__codelineno-0-841 name=__codelineno-0-841></a>                <span class=p>)</span>
<a id=__codelineno-0-842 name=__codelineno-0-842></a>                <span class=k>if</span> <span class=n>response</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-0-843 name=__codelineno-0-843></a>                    <span class=k>return</span> <span class=n>response</span>
<a id=__codelineno-0-844 name=__codelineno-0-844></a>                <span class=n>pass_filter</span> <span class=o>=</span> <span class=n>filter_func</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>filter_func</span><span class=p>(</span><span class=n>context</span><span class=o>=</span><span class=n>context</span><span class=p>,</span> <span class=n>response</span><span class=o>=</span><span class=n>response</span><span class=p>)</span>
<a id=__codelineno-0-845 name=__codelineno-0-845></a>                <span class=k>if</span> <span class=n>pass_filter</span> <span class=ow>or</span> <span class=n>i</span> <span class=o>==</span> <span class=n>last</span><span class=p>:</span>
<a id=__codelineno-0-846 name=__codelineno-0-846></a>                    <span class=n>response</span><span class=p>[</span><span class=s2>&quot;cost&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cost</span> <span class=o>+</span> <span class=n>response</span><span class=p>[</span><span class=s2>&quot;cost&quot;</span><span class=p>]</span>
<a id=__codelineno-0-847 name=__codelineno-0-847></a>                    <span class=n>response</span><span class=p>[</span><span class=s2>&quot;config_id&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
<a id=__codelineno-0-848 name=__codelineno-0-848></a>                    <span class=n>response</span><span class=p>[</span><span class=s2>&quot;pass_filter&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pass_filter</span>
<a id=__codelineno-0-849 name=__codelineno-0-849></a>                    <span class=k>return</span> <span class=n>response</span>
<a id=__codelineno-0-850 name=__codelineno-0-850></a>                <span class=n>cost</span> <span class=o>+=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&quot;cost&quot;</span><span class=p>]</span>
<a id=__codelineno-0-851 name=__codelineno-0-851></a>            <span class=k>except</span> <span class=p>(</span><span class=n>AuthenticationError</span><span class=p>,</span> <span class=n>RateLimitError</span><span class=p>,</span> <span class=n>Timeout</span><span class=p>,</span> <span class=n>BadRequestError</span><span class=p>):</span>
<a id=__codelineno-0-852 name=__codelineno-0-852></a>                <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;failed with config </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>exc_info</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-853 name=__codelineno-0-853></a>                <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=n>last</span><span class=p>:</span>
<a id=__codelineno-0-854 name=__codelineno-0-854></a>                    <span class=k>raise</span>
<a id=__codelineno-0-855 name=__codelineno-0-855></a>    <span class=n>params</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_construct_params</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>config</span><span class=p>,</span> <span class=n>allow_format_str_template</span><span class=o>=</span><span class=n>allow_format_str_template</span><span class=p>)</span>
<a id=__codelineno-0-856 name=__codelineno-0-856></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>use_cache</span><span class=p>:</span>
<a id=__codelineno-0-857 name=__codelineno-0-857></a>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_get_response</span><span class=p>(</span>
<a id=__codelineno-0-858 name=__codelineno-0-858></a>            <span class=n>params</span><span class=p>,</span> <span class=n>raise_on_ratelimit_or_timeout</span><span class=o>=</span><span class=n>raise_on_ratelimit_or_timeout</span><span class=p>,</span> <span class=n>use_cache</span><span class=o>=</span><span class=kc>False</span>
<a id=__codelineno-0-859 name=__codelineno-0-859></a>        <span class=p>)</span>
<a id=__codelineno-0-860 name=__codelineno-0-860></a>    <span class=n>cache_seed</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>cache_seed</span>
<a id=__codelineno-0-861 name=__codelineno-0-861></a>    <span class=k>if</span> <span class=s2>&quot;cache_seed&quot;</span> <span class=ow>in</span> <span class=n>params</span><span class=p>:</span>
<a id=__codelineno-0-862 name=__codelineno-0-862></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>set_cache</span><span class=p>(</span><span class=n>params</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;cache_seed&quot;</span><span class=p>))</span>
<a id=__codelineno-0-863 name=__codelineno-0-863></a>    <span class=k>with</span> <span class=n>diskcache</span><span class=o>.</span><span class=n>Cache</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>cache_path</span><span class=p>)</span> <span class=k>as</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_cache</span><span class=p>:</span>
<a id=__codelineno-0-864 name=__codelineno-0-864></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>set_cache</span><span class=p>(</span><span class=n>cache_seed</span><span class=p>)</span>
<a id=__codelineno-0-865 name=__codelineno-0-865></a>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_get_response</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>raise_on_ratelimit_or_timeout</span><span class=o>=</span><span class=n>raise_on_ratelimit_or_timeout</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.instantiate class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">instantiate</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.instantiate class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>instantiate</span><span class=p>(</span><span class=n>template</span><span class=p>,</span> <span class=n>context</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>allow_format_str_template</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-867>867</a></span>
<span class=normal><a href=#__codelineno-0-868>868</a></span>
<span class=normal><a href=#__codelineno-0-869>869</a></span>
<span class=normal><a href=#__codelineno-0-870>870</a></span>
<span class=normal><a href=#__codelineno-0-871>871</a></span>
<span class=normal><a href=#__codelineno-0-872>872</a></span>
<span class=normal><a href=#__codelineno-0-873>873</a></span>
<span class=normal><a href=#__codelineno-0-874>874</a></span>
<span class=normal><a href=#__codelineno-0-875>875</a></span>
<span class=normal><a href=#__codelineno-0-876>876</a></span>
<span class=normal><a href=#__codelineno-0-877>877</a></span>
<span class=normal><a href=#__codelineno-0-878>878</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-867 name=__codelineno-0-867></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-868 name=__codelineno-0-868></a><span class=k>def</span><span class=w> </span><span class=nf>instantiate</span><span class=p>(</span>
<a id=__codelineno-0-869 name=__codelineno-0-869></a>    <span class=bp>cls</span><span class=p>,</span>
<a id=__codelineno-0-870 name=__codelineno-0-870></a>    <span class=n>template</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=kc>None</span><span class=p>],</span>
<a id=__codelineno-0-871 name=__codelineno-0-871></a>    <span class=n>context</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-872 name=__codelineno-0-872></a>    <span class=n>allow_format_str_template</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-873 name=__codelineno-0-873></a><span class=p>):</span>
<a id=__codelineno-0-874 name=__codelineno-0-874></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>context</span> <span class=ow>or</span> <span class=n>template</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-875 name=__codelineno-0-875></a>        <span class=k>return</span> <span class=n>template</span>
<a id=__codelineno-0-876 name=__codelineno-0-876></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>template</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<a id=__codelineno-0-877 name=__codelineno-0-877></a>        <span class=k>return</span> <span class=n>template</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>**</span><span class=n>context</span><span class=p>)</span> <span class=k>if</span> <span class=n>allow_format_str_template</span> <span class=k>else</span> <span class=n>template</span>
<a id=__codelineno-0-878 name=__codelineno-0-878></a>    <span class=k>return</span> <span class=n>template</span><span class=p>(</span><span class=n>context</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.test class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">test</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.test class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>test</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>eval_func</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>use_cache</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>agg_method</span><span class=o>=</span><span class=s1>&#39;avg&#39;</span><span class=p>,</span> <span class=n>return_responses_and_per_instance_result</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>logging_level</span><span class=o>=</span><span class=n><a class="autorefs autorefs-external" title=logging.WARNING href=https://docs.python.org/3/library/logging.html#logging.WARNING>WARNING</a></span><span class=p>,</span> <span class=o>**</span><span class=n>config</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Evaluate the responses created with the config for the OpenAI API call.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The list of test data points.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#list>list</a></code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>eval_func</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The evaluation function for responses per data instance. The function should take a list of responses and a data point as input, and return a dict of metrics. You need to either provide a valid callable eval_func; or do not provide one (set None) but call the test function after calling the tune function in which a eval_func is provided. In the latter case we will use the eval_func provided via tune function. Defaults to None.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" title=typing.Callable href=https://docs.python.org/3/library/typing.html#typing.Callable>Callable</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <p><div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>def</span><span class=w> </span><span class=nf>eval_func</span><span class=p>(</span><span class=n>responses</span><span class=p>,</span> <span class=o>**</span><span class=n>data</span><span class=p>):</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    <span class=n>solution</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;solution&quot;</span><span class=p>]</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    <span class=n>success_list</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>responses</span><span class=p>)</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>responses</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>        <span class=n>succeed</span> <span class=o>=</span> <span class=n>is_equiv_chain_of_thought</span><span class=p>(</span><span class=n>response</span><span class=p>,</span> <span class=n>solution</span><span class=p>)</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>        <span class=n>success_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>succeed</span><span class=p>)</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>    <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>        <span class=s2>&quot;expected_success&quot;</span><span class=p>:</span> <span class=mi>1</span> <span class=o>-</span> <span class=nb>pow</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=nb>sum</span><span class=p>(</span><span class=n>success_list</span><span class=p>)</span> <span class=o>/</span> <span class=n>n</span><span class=p>,</span> <span class=n>n</span><span class=p>),</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>        <span class=s2>&quot;success&quot;</span><span class=p>:</span> <span class=nb>any</span><span class=p>(</span><span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>success_list</span><span class=p>),</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>    <span class=p>}</span>
</code></pre></div> use_cache (bool, Optional): Whether to use cached responses. Defaults to True. agg_method (str, Callable or a dict of Callable): Result aggregation method (across multiple instances) for each of the metrics. Defaults to 'avg'. An example agg_method in str:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>agg_method</span> <span class=o>=</span> <span class=s2>&quot;median&quot;</span>
</code></pre></div> An example agg_method in a Callable:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>agg_method</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>median</span>
</code></pre></div> <div class=highlight><pre><span></span><code>    An example agg_method in a dict of Callable:
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>agg_method</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;median_success&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>median</span><span class=p>,</span> <span class=s2>&quot;avg_success&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code>return_responses_and_per_instance_result (bool): Whether to also return responses
    and per instance results in addition to the aggregated results.
logging_level (optional): logging level. Defaults to logging.WARNING.
**config (dict): parameters passed to the openai api call `create()`.
</code></pre></div> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>None when no valid eval_func is provided in either test or tune;</p> </div> </td> </tr> <tr class=doc-section-item> <td> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Otherwise, a dict of aggregated results, responses and per instance results if <code>return_responses_and_per_instance_result</code> is True;</p> </div> </td> </tr> <tr class=doc-section-item> <td> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Otherwise, a dict of aggregated results (responses and per instance results are not returned).</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-919> 919</a></span>
<span class=normal><a href=#__codelineno-0-920> 920</a></span>
<span class=normal><a href=#__codelineno-0-921> 921</a></span>
<span class=normal><a href=#__codelineno-0-922> 922</a></span>
<span class=normal><a href=#__codelineno-0-923> 923</a></span>
<span class=normal><a href=#__codelineno-0-924> 924</a></span>
<span class=normal><a href=#__codelineno-0-925> 925</a></span>
<span class=normal><a href=#__codelineno-0-926> 926</a></span>
<span class=normal><a href=#__codelineno-0-927> 927</a></span>
<span class=normal><a href=#__codelineno-0-928> 928</a></span>
<span class=normal><a href=#__codelineno-0-929> 929</a></span>
<span class=normal><a href=#__codelineno-0-930> 930</a></span>
<span class=normal><a href=#__codelineno-0-931> 931</a></span>
<span class=normal><a href=#__codelineno-0-932> 932</a></span>
<span class=normal><a href=#__codelineno-0-933> 933</a></span>
<span class=normal><a href=#__codelineno-0-934> 934</a></span>
<span class=normal><a href=#__codelineno-0-935> 935</a></span>
<span class=normal><a href=#__codelineno-0-936> 936</a></span>
<span class=normal><a href=#__codelineno-0-937> 937</a></span>
<span class=normal><a href=#__codelineno-0-938> 938</a></span>
<span class=normal><a href=#__codelineno-0-939> 939</a></span>
<span class=normal><a href=#__codelineno-0-940> 940</a></span>
<span class=normal><a href=#__codelineno-0-941> 941</a></span>
<span class=normal><a href=#__codelineno-0-942> 942</a></span>
<span class=normal><a href=#__codelineno-0-943> 943</a></span>
<span class=normal><a href=#__codelineno-0-944> 944</a></span>
<span class=normal><a href=#__codelineno-0-945> 945</a></span>
<span class=normal><a href=#__codelineno-0-946> 946</a></span>
<span class=normal><a href=#__codelineno-0-947> 947</a></span>
<span class=normal><a href=#__codelineno-0-948> 948</a></span>
<span class=normal><a href=#__codelineno-0-949> 949</a></span>
<span class=normal><a href=#__codelineno-0-950> 950</a></span>
<span class=normal><a href=#__codelineno-0-951> 951</a></span>
<span class=normal><a href=#__codelineno-0-952> 952</a></span>
<span class=normal><a href=#__codelineno-0-953> 953</a></span>
<span class=normal><a href=#__codelineno-0-954> 954</a></span>
<span class=normal><a href=#__codelineno-0-955> 955</a></span>
<span class=normal><a href=#__codelineno-0-956> 956</a></span>
<span class=normal><a href=#__codelineno-0-957> 957</a></span>
<span class=normal><a href=#__codelineno-0-958> 958</a></span>
<span class=normal><a href=#__codelineno-0-959> 959</a></span>
<span class=normal><a href=#__codelineno-0-960> 960</a></span>
<span class=normal><a href=#__codelineno-0-961> 961</a></span>
<span class=normal><a href=#__codelineno-0-962> 962</a></span>
<span class=normal><a href=#__codelineno-0-963> 963</a></span>
<span class=normal><a href=#__codelineno-0-964> 964</a></span>
<span class=normal><a href=#__codelineno-0-965> 965</a></span>
<span class=normal><a href=#__codelineno-0-966> 966</a></span>
<span class=normal><a href=#__codelineno-0-967> 967</a></span>
<span class=normal><a href=#__codelineno-0-968> 968</a></span>
<span class=normal><a href=#__codelineno-0-969> 969</a></span>
<span class=normal><a href=#__codelineno-0-970> 970</a></span>
<span class=normal><a href=#__codelineno-0-971> 971</a></span>
<span class=normal><a href=#__codelineno-0-972> 972</a></span>
<span class=normal><a href=#__codelineno-0-973> 973</a></span>
<span class=normal><a href=#__codelineno-0-974> 974</a></span>
<span class=normal><a href=#__codelineno-0-975> 975</a></span>
<span class=normal><a href=#__codelineno-0-976> 976</a></span>
<span class=normal><a href=#__codelineno-0-977> 977</a></span>
<span class=normal><a href=#__codelineno-0-978> 978</a></span>
<span class=normal><a href=#__codelineno-0-979> 979</a></span>
<span class=normal><a href=#__codelineno-0-980> 980</a></span>
<span class=normal><a href=#__codelineno-0-981> 981</a></span>
<span class=normal><a href=#__codelineno-0-982> 982</a></span>
<span class=normal><a href=#__codelineno-0-983> 983</a></span>
<span class=normal><a href=#__codelineno-0-984> 984</a></span>
<span class=normal><a href=#__codelineno-0-985> 985</a></span>
<span class=normal><a href=#__codelineno-0-986> 986</a></span>
<span class=normal><a href=#__codelineno-0-987> 987</a></span>
<span class=normal><a href=#__codelineno-0-988> 988</a></span>
<span class=normal><a href=#__codelineno-0-989> 989</a></span>
<span class=normal><a href=#__codelineno-0-990> 990</a></span>
<span class=normal><a href=#__codelineno-0-991> 991</a></span>
<span class=normal><a href=#__codelineno-0-992> 992</a></span>
<span class=normal><a href=#__codelineno-0-993> 993</a></span>
<span class=normal><a href=#__codelineno-0-994> 994</a></span>
<span class=normal><a href=#__codelineno-0-995> 995</a></span>
<span class=normal><a href=#__codelineno-0-996> 996</a></span>
<span class=normal><a href=#__codelineno-0-997> 997</a></span>
<span class=normal><a href=#__codelineno-0-998> 998</a></span>
<span class=normal><a href=#__codelineno-0-999> 999</a></span>
<span class=normal><a href=#__codelineno-0-1000>1000</a></span>
<span class=normal><a href=#__codelineno-0-1001>1001</a></span>
<span class=normal><a href=#__codelineno-0-1002>1002</a></span>
<span class=normal><a href=#__codelineno-0-1003>1003</a></span>
<span class=normal><a href=#__codelineno-0-1004>1004</a></span>
<span class=normal><a href=#__codelineno-0-1005>1005</a></span>
<span class=normal><a href=#__codelineno-0-1006>1006</a></span>
<span class=normal><a href=#__codelineno-0-1007>1007</a></span>
<span class=normal><a href=#__codelineno-0-1008>1008</a></span>
<span class=normal><a href=#__codelineno-0-1009>1009</a></span>
<span class=normal><a href=#__codelineno-0-1010>1010</a></span>
<span class=normal><a href=#__codelineno-0-1011>1011</a></span>
<span class=normal><a href=#__codelineno-0-1012>1012</a></span>
<span class=normal><a href=#__codelineno-0-1013>1013</a></span>
<span class=normal><a href=#__codelineno-0-1014>1014</a></span>
<span class=normal><a href=#__codelineno-0-1015>1015</a></span>
<span class=normal><a href=#__codelineno-0-1016>1016</a></span>
<span class=normal><a href=#__codelineno-0-1017>1017</a></span>
<span class=normal><a href=#__codelineno-0-1018>1018</a></span>
<span class=normal><a href=#__codelineno-0-1019>1019</a></span>
<span class=normal><a href=#__codelineno-0-1020>1020</a></span>
<span class=normal><a href=#__codelineno-0-1021>1021</a></span>
<span class=normal><a href=#__codelineno-0-1022>1022</a></span>
<span class=normal><a href=#__codelineno-0-1023>1023</a></span>
<span class=normal><a href=#__codelineno-0-1024>1024</a></span>
<span class=normal><a href=#__codelineno-0-1025>1025</a></span>
<span class=normal><a href=#__codelineno-0-1026>1026</a></span>
<span class=normal><a href=#__codelineno-0-1027>1027</a></span>
<span class=normal><a href=#__codelineno-0-1028>1028</a></span>
<span class=normal><a href=#__codelineno-0-1029>1029</a></span>
<span class=normal><a href=#__codelineno-0-1030>1030</a></span>
<span class=normal><a href=#__codelineno-0-1031>1031</a></span>
<span class=normal><a href=#__codelineno-0-1032>1032</a></span>
<span class=normal><a href=#__codelineno-0-1033>1033</a></span>
<span class=normal><a href=#__codelineno-0-1034>1034</a></span>
<span class=normal><a href=#__codelineno-0-1035>1035</a></span>
<span class=normal><a href=#__codelineno-0-1036>1036</a></span>
<span class=normal><a href=#__codelineno-0-1037>1037</a></span>
<span class=normal><a href=#__codelineno-0-1038>1038</a></span>
<span class=normal><a href=#__codelineno-0-1039>1039</a></span>
<span class=normal><a href=#__codelineno-0-1040>1040</a></span>
<span class=normal><a href=#__codelineno-0-1041>1041</a></span>
<span class=normal><a href=#__codelineno-0-1042>1042</a></span>
<span class=normal><a href=#__codelineno-0-1043>1043</a></span>
<span class=normal><a href=#__codelineno-0-1044>1044</a></span>
<span class=normal><a href=#__codelineno-0-1045>1045</a></span>
<span class=normal><a href=#__codelineno-0-1046>1046</a></span>
<span class=normal><a href=#__codelineno-0-1047>1047</a></span>
<span class=normal><a href=#__codelineno-0-1048>1048</a></span>
<span class=normal><a href=#__codelineno-0-1049>1049</a></span>
<span class=normal><a href=#__codelineno-0-1050>1050</a></span>
<span class=normal><a href=#__codelineno-0-1051>1051</a></span>
<span class=normal><a href=#__codelineno-0-1052>1052</a></span>
<span class=normal><a href=#__codelineno-0-1053>1053</a></span>
<span class=normal><a href=#__codelineno-0-1054>1054</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-919 name=__codelineno-0-919></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-920 name=__codelineno-0-920></a><span class=nd>@require_optional_import</span><span class=p>(</span><span class=s2>&quot;numpy&quot;</span><span class=p>,</span> <span class=s2>&quot;flaml&quot;</span><span class=p>)</span>
<a id=__codelineno-0-921 name=__codelineno-0-921></a><span class=k>def</span><span class=w> </span><span class=nf>test</span><span class=p>(</span>
<a id=__codelineno-0-922 name=__codelineno-0-922></a>    <span class=bp>cls</span><span class=p>,</span>
<a id=__codelineno-0-923 name=__codelineno-0-923></a>    <span class=n>data</span><span class=p>,</span>
<a id=__codelineno-0-924 name=__codelineno-0-924></a>    <span class=n>eval_func</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-925 name=__codelineno-0-925></a>    <span class=n>use_cache</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-926 name=__codelineno-0-926></a>    <span class=n>agg_method</span><span class=o>=</span><span class=s2>&quot;avg&quot;</span><span class=p>,</span>
<a id=__codelineno-0-927 name=__codelineno-0-927></a>    <span class=n>return_responses_and_per_instance_result</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-928 name=__codelineno-0-928></a>    <span class=n>logging_level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>WARNING</span><span class=p>,</span>
<a id=__codelineno-0-929 name=__codelineno-0-929></a>    <span class=o>**</span><span class=n>config</span><span class=p>,</span>
<a id=__codelineno-0-930 name=__codelineno-0-930></a><span class=p>):</span>
<a id=__codelineno-0-931 name=__codelineno-0-931></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Evaluate the responses created with the config for the OpenAI API call.</span>
<a id=__codelineno-0-932 name=__codelineno-0-932></a>
<a id=__codelineno-0-933 name=__codelineno-0-933></a><span class=sd>    Args:</span>
<a id=__codelineno-0-934 name=__codelineno-0-934></a><span class=sd>        data (list): The list of test data points.</span>
<a id=__codelineno-0-935 name=__codelineno-0-935></a><span class=sd>        eval_func (Callable): The evaluation function for responses per data instance.</span>
<a id=__codelineno-0-936 name=__codelineno-0-936></a><span class=sd>            The function should take a list of responses and a data point as input,</span>
<a id=__codelineno-0-937 name=__codelineno-0-937></a><span class=sd>            and return a dict of metrics. You need to either provide a valid callable</span>
<a id=__codelineno-0-938 name=__codelineno-0-938></a><span class=sd>            eval_func; or do not provide one (set None) but call the test function after</span>
<a id=__codelineno-0-939 name=__codelineno-0-939></a><span class=sd>            calling the tune function in which a eval_func is provided.</span>
<a id=__codelineno-0-940 name=__codelineno-0-940></a><span class=sd>            In the latter case we will use the eval_func provided via tune function.</span>
<a id=__codelineno-0-941 name=__codelineno-0-941></a><span class=sd>            Defaults to None.</span>
<a id=__codelineno-0-942 name=__codelineno-0-942></a>
<a id=__codelineno-0-943 name=__codelineno-0-943></a><span class=sd>    ```python</span>
<a id=__codelineno-0-944 name=__codelineno-0-944></a><span class=sd>    def eval_func(responses, **data):</span>
<a id=__codelineno-0-945 name=__codelineno-0-945></a><span class=sd>        solution = data[&quot;solution&quot;]</span>
<a id=__codelineno-0-946 name=__codelineno-0-946></a><span class=sd>        success_list = []</span>
<a id=__codelineno-0-947 name=__codelineno-0-947></a><span class=sd>        n = len(responses)</span>
<a id=__codelineno-0-948 name=__codelineno-0-948></a><span class=sd>        for i in range(n):</span>
<a id=__codelineno-0-949 name=__codelineno-0-949></a><span class=sd>            response = responses[i]</span>
<a id=__codelineno-0-950 name=__codelineno-0-950></a><span class=sd>            succeed = is_equiv_chain_of_thought(response, solution)</span>
<a id=__codelineno-0-951 name=__codelineno-0-951></a><span class=sd>            success_list.append(succeed)</span>
<a id=__codelineno-0-952 name=__codelineno-0-952></a><span class=sd>        return {</span>
<a id=__codelineno-0-953 name=__codelineno-0-953></a><span class=sd>            &quot;expected_success&quot;: 1 - pow(1 - sum(success_list) / n, n),</span>
<a id=__codelineno-0-954 name=__codelineno-0-954></a><span class=sd>            &quot;success&quot;: any(s for s in success_list),</span>
<a id=__codelineno-0-955 name=__codelineno-0-955></a><span class=sd>        }</span>
<a id=__codelineno-0-956 name=__codelineno-0-956></a><span class=sd>    ```</span>
<a id=__codelineno-0-957 name=__codelineno-0-957></a><span class=sd>        use_cache (bool, Optional): Whether to use cached responses. Defaults to True.</span>
<a id=__codelineno-0-958 name=__codelineno-0-958></a><span class=sd>        agg_method (str, Callable or a dict of Callable): Result aggregation method (across</span>
<a id=__codelineno-0-959 name=__codelineno-0-959></a><span class=sd>            multiple instances) for each of the metrics. Defaults to &#39;avg&#39;.</span>
<a id=__codelineno-0-960 name=__codelineno-0-960></a><span class=sd>            An example agg_method in str:</span>
<a id=__codelineno-0-961 name=__codelineno-0-961></a>
<a id=__codelineno-0-962 name=__codelineno-0-962></a><span class=sd>    ```python</span>
<a id=__codelineno-0-963 name=__codelineno-0-963></a><span class=sd>    agg_method = &quot;median&quot;</span>
<a id=__codelineno-0-964 name=__codelineno-0-964></a><span class=sd>    ```</span>
<a id=__codelineno-0-965 name=__codelineno-0-965></a><span class=sd>            An example agg_method in a Callable:</span>
<a id=__codelineno-0-966 name=__codelineno-0-966></a>
<a id=__codelineno-0-967 name=__codelineno-0-967></a><span class=sd>    ```python</span>
<a id=__codelineno-0-968 name=__codelineno-0-968></a><span class=sd>    agg_method = np.median</span>
<a id=__codelineno-0-969 name=__codelineno-0-969></a><span class=sd>    ```</span>
<a id=__codelineno-0-970 name=__codelineno-0-970></a>
<a id=__codelineno-0-971 name=__codelineno-0-971></a><span class=sd>            An example agg_method in a dict of Callable:</span>
<a id=__codelineno-0-972 name=__codelineno-0-972></a>
<a id=__codelineno-0-973 name=__codelineno-0-973></a><span class=sd>    ```python</span>
<a id=__codelineno-0-974 name=__codelineno-0-974></a><span class=sd>    agg_method = {&quot;median_success&quot;: np.median, &quot;avg_success&quot;: np.mean}</span>
<a id=__codelineno-0-975 name=__codelineno-0-975></a><span class=sd>    ```</span>
<a id=__codelineno-0-976 name=__codelineno-0-976></a>
<a id=__codelineno-0-977 name=__codelineno-0-977></a><span class=sd>        return_responses_and_per_instance_result (bool): Whether to also return responses</span>
<a id=__codelineno-0-978 name=__codelineno-0-978></a><span class=sd>            and per instance results in addition to the aggregated results.</span>
<a id=__codelineno-0-979 name=__codelineno-0-979></a><span class=sd>        logging_level (optional): logging level. Defaults to logging.WARNING.</span>
<a id=__codelineno-0-980 name=__codelineno-0-980></a><span class=sd>        **config (dict): parameters passed to the openai api call `create()`.</span>
<a id=__codelineno-0-981 name=__codelineno-0-981></a>
<a id=__codelineno-0-982 name=__codelineno-0-982></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-983 name=__codelineno-0-983></a><span class=sd>        None when no valid eval_func is provided in either test or tune;</span>
<a id=__codelineno-0-984 name=__codelineno-0-984></a><span class=sd>        Otherwise, a dict of aggregated results, responses and per instance results if `return_responses_and_per_instance_result` is True;</span>
<a id=__codelineno-0-985 name=__codelineno-0-985></a><span class=sd>        Otherwise, a dict of aggregated results (responses and per instance results are not returned).</span>
<a id=__codelineno-0-986 name=__codelineno-0-986></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-987 name=__codelineno-0-987></a>    <span class=n>result_agg</span><span class=p>,</span> <span class=n>responses_list</span><span class=p>,</span> <span class=n>result_list</span> <span class=o>=</span> <span class=p>{},</span> <span class=p>[],</span> <span class=p>[]</span>
<a id=__codelineno-0-988 name=__codelineno-0-988></a>    <span class=n>metric_keys</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-989 name=__codelineno-0-989></a>    <span class=n>cost</span> <span class=o>=</span> <span class=mi>0</span>
<a id=__codelineno-0-990 name=__codelineno-0-990></a>    <span class=n>old_level</span> <span class=o>=</span> <span class=n>logger</span><span class=o>.</span><span class=n>getEffectiveLevel</span><span class=p>()</span>
<a id=__codelineno-0-991 name=__codelineno-0-991></a>    <span class=n>logger</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>logging_level</span><span class=p>)</span>
<a id=__codelineno-0-992 name=__codelineno-0-992></a>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>data_i</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
<a id=__codelineno-0-993 name=__codelineno-0-993></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;evaluating data instance </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-994 name=__codelineno-0-994></a>        <span class=n>response</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>data_i</span><span class=p>,</span> <span class=n>use_cache</span><span class=p>,</span> <span class=o>**</span><span class=n>config</span><span class=p>)</span>
<a id=__codelineno-0-995 name=__codelineno-0-995></a>        <span class=n>cost</span> <span class=o>+=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&quot;cost&quot;</span><span class=p>]</span>
<a id=__codelineno-0-996 name=__codelineno-0-996></a>        <span class=c1># evaluate the quality of the responses</span>
<a id=__codelineno-0-997 name=__codelineno-0-997></a>        <span class=n>responses</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>extract_text_or_function_call</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
<a id=__codelineno-0-998 name=__codelineno-0-998></a>        <span class=k>if</span> <span class=n>eval_func</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-999 name=__codelineno-0-999></a>            <span class=n>metrics</span> <span class=o>=</span> <span class=n>eval_func</span><span class=p>(</span><span class=n>responses</span><span class=p>,</span> <span class=o>**</span><span class=n>data_i</span><span class=p>)</span>
<a id=__codelineno-0-1000 name=__codelineno-0-1000></a>        <span class=k>elif</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=s2>&quot;_eval_func&quot;</span><span class=p>):</span>
<a id=__codelineno-0-1001 name=__codelineno-0-1001></a>            <span class=n>metrics</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_eval_func</span><span class=p>(</span><span class=n>responses</span><span class=p>,</span> <span class=o>**</span><span class=n>data_i</span><span class=p>)</span>
<a id=__codelineno-0-1002 name=__codelineno-0-1002></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1003 name=__codelineno-0-1003></a>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<a id=__codelineno-0-1004 name=__codelineno-0-1004></a>                <span class=s2>&quot;Please either provide a valid eval_func or do the test after the tune function is called.&quot;</span>
<a id=__codelineno-0-1005 name=__codelineno-0-1005></a>            <span class=p>)</span>
<a id=__codelineno-0-1006 name=__codelineno-0-1006></a>            <span class=k>return</span>
<a id=__codelineno-0-1007 name=__codelineno-0-1007></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>metric_keys</span><span class=p>:</span>
<a id=__codelineno-0-1008 name=__codelineno-0-1008></a>            <span class=n>metric_keys</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-0-1009 name=__codelineno-0-1009></a>            <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>metrics</span><span class=p>:</span>
<a id=__codelineno-0-1010 name=__codelineno-0-1010></a>                <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-1011 name=__codelineno-0-1011></a>                    <span class=n>_</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>metrics</span><span class=p>[</span><span class=n>k</span><span class=p>])</span>
<a id=__codelineno-0-1012 name=__codelineno-0-1012></a>                    <span class=n>metric_keys</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>k</span><span class=p>)</span>
<a id=__codelineno-0-1013 name=__codelineno-0-1013></a>                <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
<a id=__codelineno-0-1014 name=__codelineno-0-1014></a>                    <span class=k>pass</span>
<a id=__codelineno-0-1015 name=__codelineno-0-1015></a>        <span class=n>result_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>metrics</span><span class=p>)</span>
<a id=__codelineno-0-1016 name=__codelineno-0-1016></a>        <span class=k>if</span> <span class=n>return_responses_and_per_instance_result</span><span class=p>:</span>
<a id=__codelineno-0-1017 name=__codelineno-0-1017></a>            <span class=n>responses_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>responses</span><span class=p>)</span>
<a id=__codelineno-0-1018 name=__codelineno-0-1018></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>agg_method</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<a id=__codelineno-0-1019 name=__codelineno-0-1019></a>        <span class=k>if</span> <span class=n>agg_method</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;avg&quot;</span><span class=p>,</span> <span class=s2>&quot;average&quot;</span><span class=p>]:</span>
<a id=__codelineno-0-1020 name=__codelineno-0-1020></a>            <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>metric_keys</span><span class=p>:</span>
<a id=__codelineno-0-1021 name=__codelineno-0-1021></a>                <span class=n>result_agg</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>([</span><span class=n>r</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>result_list</span><span class=p>])</span>
<a id=__codelineno-0-1022 name=__codelineno-0-1022></a>        <span class=k>elif</span> <span class=n>agg_method</span> <span class=o>==</span> <span class=s2>&quot;median&quot;</span><span class=p>:</span>
<a id=__codelineno-0-1023 name=__codelineno-0-1023></a>            <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>metric_keys</span><span class=p>:</span>
<a id=__codelineno-0-1024 name=__codelineno-0-1024></a>                <span class=n>result_agg</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>median</span><span class=p>([</span><span class=n>r</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>result_list</span><span class=p>])</span>
<a id=__codelineno-0-1025 name=__codelineno-0-1025></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1026 name=__codelineno-0-1026></a>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<a id=__codelineno-0-1027 name=__codelineno-0-1027></a>                <span class=sa>f</span><span class=s2>&quot;Aggregation method </span><span class=si>{</span><span class=n>agg_method</span><span class=si>}</span><span class=s2> not supported. Please write your own aggregation method as a callable(s).&quot;</span>
<a id=__codelineno-0-1028 name=__codelineno-0-1028></a>            <span class=p>)</span>
<a id=__codelineno-0-1029 name=__codelineno-0-1029></a>    <span class=k>elif</span> <span class=nb>callable</span><span class=p>(</span><span class=n>agg_method</span><span class=p>):</span>
<a id=__codelineno-0-1030 name=__codelineno-0-1030></a>        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>metric_keys</span><span class=p>:</span>
<a id=__codelineno-0-1031 name=__codelineno-0-1031></a>            <span class=n>result_agg</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>agg_method</span><span class=p>([</span><span class=n>r</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>result_list</span><span class=p>])</span>
<a id=__codelineno-0-1032 name=__codelineno-0-1032></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>agg_method</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
<a id=__codelineno-0-1033 name=__codelineno-0-1033></a>        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>metric_keys</span><span class=p>:</span>
<a id=__codelineno-0-1034 name=__codelineno-0-1034></a>            <span class=n>metric_agg_method</span> <span class=o>=</span> <span class=n>agg_method</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
<a id=__codelineno-0-1035 name=__codelineno-0-1035></a>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>callable</span><span class=p>(</span><span class=n>metric_agg_method</span><span class=p>):</span>
<a id=__codelineno-0-1036 name=__codelineno-0-1036></a>                <span class=n>error_msg</span> <span class=o>=</span> <span class=s2>&quot;please provide a callable for each metric&quot;</span>
<a id=__codelineno-0-1037 name=__codelineno-0-1037></a>                <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-1038 name=__codelineno-0-1038></a>                <span class=k>raise</span> <span class=ne>AssertionError</span><span class=p>(</span><span class=n>error_msg</span><span class=p>)</span>
<a id=__codelineno-0-1039 name=__codelineno-0-1039></a>            <span class=n>result_agg</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>metric_agg_method</span><span class=p>([</span><span class=n>r</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>result_list</span><span class=p>])</span>
<a id=__codelineno-0-1040 name=__codelineno-0-1040></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1041 name=__codelineno-0-1041></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
<a id=__codelineno-0-1042 name=__codelineno-0-1042></a>            <span class=s2>&quot;agg_method needs to be a string (&#39;avg&#39; or &#39;median&#39;),</span><span class=se>\</span>
<a id=__codelineno-0-1043 name=__codelineno-0-1043></a><span class=s2>            or a callable, or a dictionary of callable.&quot;</span>
<a id=__codelineno-0-1044 name=__codelineno-0-1044></a>        <span class=p>)</span>
<a id=__codelineno-0-1045 name=__codelineno-0-1045></a>    <span class=n>logger</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>old_level</span><span class=p>)</span>
<a id=__codelineno-0-1046 name=__codelineno-0-1046></a>    <span class=c1># should we also return the result_list and responses_list or not?</span>
<a id=__codelineno-0-1047 name=__codelineno-0-1047></a>    <span class=k>if</span> <span class=s2>&quot;cost&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>result_agg</span><span class=p>:</span>
<a id=__codelineno-0-1048 name=__codelineno-0-1048></a>        <span class=n>result_agg</span><span class=p>[</span><span class=s2>&quot;cost&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cost</span>
<a id=__codelineno-0-1049 name=__codelineno-0-1049></a>    <span class=k>if</span> <span class=s2>&quot;inference_cost&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>result_agg</span><span class=p>:</span>
<a id=__codelineno-0-1050 name=__codelineno-0-1050></a>        <span class=n>result_agg</span><span class=p>[</span><span class=s2>&quot;inference_cost&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cost</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=__codelineno-0-1051 name=__codelineno-0-1051></a>    <span class=k>if</span> <span class=n>return_responses_and_per_instance_result</span><span class=p>:</span>
<a id=__codelineno-0-1052 name=__codelineno-0-1052></a>        <span class=k>return</span> <span class=n>result_agg</span><span class=p>,</span> <span class=n>result_list</span><span class=p>,</span> <span class=n>responses_list</span>
<a id=__codelineno-0-1053 name=__codelineno-0-1053></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1054 name=__codelineno-0-1054></a>        <span class=k>return</span> <span class=n>result_agg</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.cost class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">cost</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.cost class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>cost</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Compute the cost of an API call.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>response</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The response from OpenAI API.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#dict>dict</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>The cost in USD. 0 if the model is not supported.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1056>1056</a></span>
<span class=normal><a href=#__codelineno-0-1057>1057</a></span>
<span class=normal><a href=#__codelineno-0-1058>1058</a></span>
<span class=normal><a href=#__codelineno-0-1059>1059</a></span>
<span class=normal><a href=#__codelineno-0-1060>1060</a></span>
<span class=normal><a href=#__codelineno-0-1061>1061</a></span>
<span class=normal><a href=#__codelineno-0-1062>1062</a></span>
<span class=normal><a href=#__codelineno-0-1063>1063</a></span>
<span class=normal><a href=#__codelineno-0-1064>1064</a></span>
<span class=normal><a href=#__codelineno-0-1065>1065</a></span>
<span class=normal><a href=#__codelineno-0-1066>1066</a></span>
<span class=normal><a href=#__codelineno-0-1067>1067</a></span>
<span class=normal><a href=#__codelineno-0-1068>1068</a></span>
<span class=normal><a href=#__codelineno-0-1069>1069</a></span>
<span class=normal><a href=#__codelineno-0-1070>1070</a></span>
<span class=normal><a href=#__codelineno-0-1071>1071</a></span>
<span class=normal><a href=#__codelineno-0-1072>1072</a></span>
<span class=normal><a href=#__codelineno-0-1073>1073</a></span>
<span class=normal><a href=#__codelineno-0-1074>1074</a></span>
<span class=normal><a href=#__codelineno-0-1075>1075</a></span>
<span class=normal><a href=#__codelineno-0-1076>1076</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1056 name=__codelineno-0-1056></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-1057 name=__codelineno-0-1057></a><span class=k>def</span><span class=w> </span><span class=nf>cost</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>response</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
<a id=__codelineno-0-1058 name=__codelineno-0-1058></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Compute the cost of an API call.</span>
<a id=__codelineno-0-1059 name=__codelineno-0-1059></a>
<a id=__codelineno-0-1060 name=__codelineno-0-1060></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1061 name=__codelineno-0-1061></a><span class=sd>        response (dict): The response from OpenAI API.</span>
<a id=__codelineno-0-1062 name=__codelineno-0-1062></a>
<a id=__codelineno-0-1063 name=__codelineno-0-1063></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1064 name=__codelineno-0-1064></a><span class=sd>        The cost in USD. 0 if the model is not supported.</span>
<a id=__codelineno-0-1065 name=__codelineno-0-1065></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1066 name=__codelineno-0-1066></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;model&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1067 name=__codelineno-0-1067></a>    <span class=k>if</span> <span class=n>model</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>price1K</span><span class=p>:</span>
<a id=__codelineno-0-1068 name=__codelineno-0-1068></a>        <span class=k>return</span> <span class=mi>0</span>
<a id=__codelineno-0-1069 name=__codelineno-0-1069></a>        <span class=c1># raise ValueError(f&quot;Unknown model: {model}&quot;)</span>
<a id=__codelineno-0-1070 name=__codelineno-0-1070></a>    <span class=n>usage</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&quot;usage&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1071 name=__codelineno-0-1071></a>    <span class=n>n_input_tokens</span> <span class=o>=</span> <span class=n>usage</span><span class=p>[</span><span class=s2>&quot;prompt_tokens&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1072 name=__codelineno-0-1072></a>    <span class=n>n_output_tokens</span> <span class=o>=</span> <span class=n>usage</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;completion_tokens&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-0-1073 name=__codelineno-0-1073></a>    <span class=n>price1K</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>price1K</span><span class=p>[</span><span class=n>model</span><span class=p>]</span>  <span class=c1># noqa: N806</span>
<a id=__codelineno-0-1074 name=__codelineno-0-1074></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>price1K</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>):</span>
<a id=__codelineno-0-1075 name=__codelineno-0-1075></a>        <span class=k>return</span> <span class=p>(</span><span class=n>price1K</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>n_input_tokens</span> <span class=o>+</span> <span class=n>price1K</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=n>n_output_tokens</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1000</span>
<a id=__codelineno-0-1076 name=__codelineno-0-1076></a>    <span class=k>return</span> <span class=n>price1K</span> <span class=o>*</span> <span class=p>(</span><span class=n>n_input_tokens</span> <span class=o>+</span> <span class=n>n_output_tokens</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1000</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.extract_text class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">extract_text</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.extract_text class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>extract_text</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Extract the text from a completion or chat response.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>response</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The response from OpenAI API.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#dict>dict</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#list>list</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A list of text in the responses.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1078>1078</a></span>
<span class=normal><a href=#__codelineno-0-1079>1079</a></span>
<span class=normal><a href=#__codelineno-0-1080>1080</a></span>
<span class=normal><a href=#__codelineno-0-1081>1081</a></span>
<span class=normal><a href=#__codelineno-0-1082>1082</a></span>
<span class=normal><a href=#__codelineno-0-1083>1083</a></span>
<span class=normal><a href=#__codelineno-0-1084>1084</a></span>
<span class=normal><a href=#__codelineno-0-1085>1085</a></span>
<span class=normal><a href=#__codelineno-0-1086>1086</a></span>
<span class=normal><a href=#__codelineno-0-1087>1087</a></span>
<span class=normal><a href=#__codelineno-0-1088>1088</a></span>
<span class=normal><a href=#__codelineno-0-1089>1089</a></span>
<span class=normal><a href=#__codelineno-0-1090>1090</a></span>
<span class=normal><a href=#__codelineno-0-1091>1091</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1078 name=__codelineno-0-1078></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-1079 name=__codelineno-0-1079></a><span class=k>def</span><span class=w> </span><span class=nf>extract_text</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>response</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<a id=__codelineno-0-1080 name=__codelineno-0-1080></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Extract the text from a completion or chat response.</span>
<a id=__codelineno-0-1081 name=__codelineno-0-1081></a>
<a id=__codelineno-0-1082 name=__codelineno-0-1082></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1083 name=__codelineno-0-1083></a><span class=sd>        response (dict): The response from OpenAI API.</span>
<a id=__codelineno-0-1084 name=__codelineno-0-1084></a>
<a id=__codelineno-0-1085 name=__codelineno-0-1085></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1086 name=__codelineno-0-1086></a><span class=sd>        A list of text in the responses.</span>
<a id=__codelineno-0-1087 name=__codelineno-0-1087></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1088 name=__codelineno-0-1088></a>    <span class=n>choices</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&quot;choices&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1089 name=__codelineno-0-1089></a>    <span class=k>if</span> <span class=s2>&quot;text&quot;</span> <span class=ow>in</span> <span class=n>choices</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span>
<a id=__codelineno-0-1090 name=__codelineno-0-1090></a>        <span class=k>return</span> <span class=p>[</span><span class=n>choice</span><span class=p>[</span><span class=s2>&quot;text&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>choice</span> <span class=ow>in</span> <span class=n>choices</span><span class=p>]</span>
<a id=__codelineno-0-1091 name=__codelineno-0-1091></a>    <span class=k>return</span> <span class=p>[</span><span class=n>choice</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;content&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span> <span class=k>for</span> <span class=n>choice</span> <span class=ow>in</span> <span class=n>choices</span><span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.extract_text_or_function_call class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">extract_text_or_function_call</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.extract_text_or_function_call class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>extract_text_or_function_call</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Extract the text or function calls from a completion or chat response.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>response</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>The response from OpenAI API.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#dict>dict</a></code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <span class=doc-returns-annotation> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#list>list</a>[<a class="autorefs autorefs-external" href=https://docs.python.org/3/library/stdtypes.html#str>str</a>]</code> </span> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>A list of text or function calls in the responses.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1093>1093</a></span>
<span class=normal><a href=#__codelineno-0-1094>1094</a></span>
<span class=normal><a href=#__codelineno-0-1095>1095</a></span>
<span class=normal><a href=#__codelineno-0-1096>1096</a></span>
<span class=normal><a href=#__codelineno-0-1097>1097</a></span>
<span class=normal><a href=#__codelineno-0-1098>1098</a></span>
<span class=normal><a href=#__codelineno-0-1099>1099</a></span>
<span class=normal><a href=#__codelineno-0-1100>1100</a></span>
<span class=normal><a href=#__codelineno-0-1101>1101</a></span>
<span class=normal><a href=#__codelineno-0-1102>1102</a></span>
<span class=normal><a href=#__codelineno-0-1103>1103</a></span>
<span class=normal><a href=#__codelineno-0-1104>1104</a></span>
<span class=normal><a href=#__codelineno-0-1105>1105</a></span>
<span class=normal><a href=#__codelineno-0-1106>1106</a></span>
<span class=normal><a href=#__codelineno-0-1107>1107</a></span>
<span class=normal><a href=#__codelineno-0-1108>1108</a></span>
<span class=normal><a href=#__codelineno-0-1109>1109</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1093 name=__codelineno-0-1093></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-1094 name=__codelineno-0-1094></a><span class=k>def</span><span class=w> </span><span class=nf>extract_text_or_function_call</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>response</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<a id=__codelineno-0-1095 name=__codelineno-0-1095></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Extract the text or function calls from a completion or chat response.</span>
<a id=__codelineno-0-1096 name=__codelineno-0-1096></a>
<a id=__codelineno-0-1097 name=__codelineno-0-1097></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1098 name=__codelineno-0-1098></a><span class=sd>        response (dict): The response from OpenAI API.</span>
<a id=__codelineno-0-1099 name=__codelineno-0-1099></a>
<a id=__codelineno-0-1100 name=__codelineno-0-1100></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-1101 name=__codelineno-0-1101></a><span class=sd>        A list of text or function calls in the responses.</span>
<a id=__codelineno-0-1102 name=__codelineno-0-1102></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1103 name=__codelineno-0-1103></a>    <span class=n>choices</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&quot;choices&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1104 name=__codelineno-0-1104></a>    <span class=k>if</span> <span class=s2>&quot;text&quot;</span> <span class=ow>in</span> <span class=n>choices</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span>
<a id=__codelineno-0-1105 name=__codelineno-0-1105></a>        <span class=k>return</span> <span class=p>[</span><span class=n>choice</span><span class=p>[</span><span class=s2>&quot;text&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>choice</span> <span class=ow>in</span> <span class=n>choices</span><span class=p>]</span>
<a id=__codelineno-0-1106 name=__codelineno-0-1106></a>    <span class=k>return</span> <span class=p>[</span>
<a id=__codelineno-0-1107 name=__codelineno-0-1107></a>        <span class=n>choice</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>]</span> <span class=k>if</span> <span class=s2>&quot;function_call&quot;</span> <span class=ow>in</span> <span class=n>choice</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>]</span> <span class=k>else</span> <span class=n>choice</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;content&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
<a id=__codelineno-0-1108 name=__codelineno-0-1108></a>        <span class=k>for</span> <span class=n>choice</span> <span class=ow>in</span> <span class=n>choices</span>
<a id=__codelineno-0-1109 name=__codelineno-0-1109></a>    <span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.print_usage_summary class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">print_usage_summary</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.print_usage_summary class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>print_usage_summary</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>Return the usage summary.</p> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1117>1117</a></span>
<span class=normal><a href=#__codelineno-0-1118>1118</a></span>
<span class=normal><a href=#__codelineno-0-1119>1119</a></span>
<span class=normal><a href=#__codelineno-0-1120>1120</a></span>
<span class=normal><a href=#__codelineno-0-1121>1121</a></span>
<span class=normal><a href=#__codelineno-0-1122>1122</a></span>
<span class=normal><a href=#__codelineno-0-1123>1123</a></span>
<span class=normal><a href=#__codelineno-0-1124>1124</a></span>
<span class=normal><a href=#__codelineno-0-1125>1125</a></span>
<span class=normal><a href=#__codelineno-0-1126>1126</a></span>
<span class=normal><a href=#__codelineno-0-1127>1127</a></span>
<span class=normal><a href=#__codelineno-0-1128>1128</a></span>
<span class=normal><a href=#__codelineno-0-1129>1129</a></span>
<span class=normal><a href=#__codelineno-0-1130>1130</a></span>
<span class=normal><a href=#__codelineno-0-1131>1131</a></span>
<span class=normal><a href=#__codelineno-0-1132>1132</a></span>
<span class=normal><a href=#__codelineno-0-1133>1133</a></span>
<span class=normal><a href=#__codelineno-0-1134>1134</a></span>
<span class=normal><a href=#__codelineno-0-1135>1135</a></span>
<span class=normal><a href=#__codelineno-0-1136>1136</a></span>
<span class=normal><a href=#__codelineno-0-1137>1137</a></span>
<span class=normal><a href=#__codelineno-0-1138>1138</a></span>
<span class=normal><a href=#__codelineno-0-1139>1139</a></span>
<span class=normal><a href=#__codelineno-0-1140>1140</a></span>
<span class=normal><a href=#__codelineno-0-1141>1141</a></span>
<span class=normal><a href=#__codelineno-0-1142>1142</a></span>
<span class=normal><a href=#__codelineno-0-1143>1143</a></span>
<span class=normal><a href=#__codelineno-0-1144>1144</a></span>
<span class=normal><a href=#__codelineno-0-1145>1145</a></span>
<span class=normal><a href=#__codelineno-0-1146>1146</a></span>
<span class=normal><a href=#__codelineno-0-1147>1147</a></span>
<span class=normal><a href=#__codelineno-0-1148>1148</a></span>
<span class=normal><a href=#__codelineno-0-1149>1149</a></span>
<span class=normal><a href=#__codelineno-0-1150>1150</a></span>
<span class=normal><a href=#__codelineno-0-1151>1151</a></span>
<span class=normal><a href=#__codelineno-0-1152>1152</a></span>
<span class=normal><a href=#__codelineno-0-1153>1153</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1117 name=__codelineno-0-1117></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-1118 name=__codelineno-0-1118></a><span class=k>def</span><span class=w> </span><span class=nf>print_usage_summary</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<a id=__codelineno-0-1119 name=__codelineno-0-1119></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the usage summary.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1120 name=__codelineno-0-1120></a>    <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_history_dict</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-0-1121 name=__codelineno-0-1121></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;No usage summary available.&quot;</span><span class=p>,</span> <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-0-1122 name=__codelineno-0-1122></a>
<a id=__codelineno-0-1123 name=__codelineno-0-1123></a>    <span class=n>token_count_summary</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=k>lambda</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;prompt_tokens&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;completion_tokens&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;total_tokens&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>})</span>
<a id=__codelineno-0-1124 name=__codelineno-0-1124></a>
<a id=__codelineno-0-1125 name=__codelineno-0-1125></a>    <span class=k>if</span> <span class=ow>not</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_history_compact</span><span class=p>:</span>
<a id=__codelineno-0-1126 name=__codelineno-0-1126></a>        <span class=n>source</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_history_dict</span><span class=o>.</span><span class=n>values</span><span class=p>()</span>
<a id=__codelineno-0-1127 name=__codelineno-0-1127></a>        <span class=n>total_cost</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>msg_pair</span><span class=p>[</span><span class=s2>&quot;response&quot;</span><span class=p>][</span><span class=s2>&quot;cost&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>msg_pair</span> <span class=ow>in</span> <span class=n>source</span><span class=p>)</span>
<a id=__codelineno-0-1128 name=__codelineno-0-1128></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1129 name=__codelineno-0-1129></a>        <span class=c1># source = cls._history_dict[&quot;token_count&quot;]</span>
<a id=__codelineno-0-1130 name=__codelineno-0-1130></a>        <span class=c1># total_cost = sum(cls._history_dict[&#39;cost&#39;])</span>
<a id=__codelineno-0-1131 name=__codelineno-0-1131></a>        <span class=n>total_cost</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=n>value_list</span><span class=p>[</span><span class=s2>&quot;cost&quot;</span><span class=p>])</span> <span class=k>for</span> <span class=n>value_list</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_history_dict</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
<a id=__codelineno-0-1132 name=__codelineno-0-1132></a>        <span class=n>source</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-0-1133 name=__codelineno-0-1133></a>            <span class=n>token_data</span> <span class=k>for</span> <span class=n>value_list</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_history_dict</span><span class=o>.</span><span class=n>values</span><span class=p>()</span> <span class=k>for</span> <span class=n>token_data</span> <span class=ow>in</span> <span class=n>value_list</span><span class=p>[</span><span class=s2>&quot;token_count&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1134 name=__codelineno-0-1134></a>        <span class=p>)</span>
<a id=__codelineno-0-1135 name=__codelineno-0-1135></a>
<a id=__codelineno-0-1136 name=__codelineno-0-1136></a>    <span class=k>for</span> <span class=n>entry</span> <span class=ow>in</span> <span class=n>source</span><span class=p>:</span>
<a id=__codelineno-0-1137 name=__codelineno-0-1137></a>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_history_compact</span><span class=p>:</span>
<a id=__codelineno-0-1138 name=__codelineno-0-1138></a>            <span class=n>model</span> <span class=o>=</span> <span class=n>entry</span><span class=p>[</span><span class=s2>&quot;response&quot;</span><span class=p>][</span><span class=s2>&quot;model&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1139 name=__codelineno-0-1139></a>            <span class=n>token_data</span> <span class=o>=</span> <span class=n>entry</span><span class=p>[</span><span class=s2>&quot;response&quot;</span><span class=p>][</span><span class=s2>&quot;usage&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1140 name=__codelineno-0-1140></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-1141 name=__codelineno-0-1141></a>            <span class=n>model</span> <span class=o>=</span> <span class=n>entry</span><span class=p>[</span><span class=s2>&quot;model&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1142 name=__codelineno-0-1142></a>            <span class=n>token_data</span> <span class=o>=</span> <span class=n>entry</span>
<a id=__codelineno-0-1143 name=__codelineno-0-1143></a>
<a id=__codelineno-0-1144 name=__codelineno-0-1144></a>        <span class=n>token_count_summary</span><span class=p>[</span><span class=n>model</span><span class=p>][</span><span class=s2>&quot;prompt_tokens&quot;</span><span class=p>]</span> <span class=o>+=</span> <span class=n>token_data</span><span class=p>[</span><span class=s2>&quot;prompt_tokens&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1145 name=__codelineno-0-1145></a>        <span class=n>token_count_summary</span><span class=p>[</span><span class=n>model</span><span class=p>][</span><span class=s2>&quot;completion_tokens&quot;</span><span class=p>]</span> <span class=o>+=</span> <span class=n>token_data</span><span class=p>[</span><span class=s2>&quot;completion_tokens&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1146 name=__codelineno-0-1146></a>        <span class=n>token_count_summary</span><span class=p>[</span><span class=n>model</span><span class=p>][</span><span class=s2>&quot;total_tokens&quot;</span><span class=p>]</span> <span class=o>+=</span> <span class=n>token_data</span><span class=p>[</span><span class=s2>&quot;total_tokens&quot;</span><span class=p>]</span>
<a id=__codelineno-0-1147 name=__codelineno-0-1147></a>
<a id=__codelineno-0-1148 name=__codelineno-0-1148></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total cost: </span><span class=si>{</span><span class=n>total_cost</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-0-1149 name=__codelineno-0-1149></a>    <span class=k>for</span> <span class=n>model</span><span class=p>,</span> <span class=n>counts</span> <span class=ow>in</span> <span class=n>token_count_summary</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-0-1150 name=__codelineno-0-1150></a>        <span class=nb>print</span><span class=p>(</span>
<a id=__codelineno-0-1151 name=__codelineno-0-1151></a>            <span class=sa>f</span><span class=s2>&quot;Token count summary for model </span><span class=si>{</span><span class=n>model</span><span class=si>}</span><span class=s2>: prompt_tokens: </span><span class=si>{</span><span class=n>counts</span><span class=p>[</span><span class=s1>&#39;prompt_tokens&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>, completion_tokens: </span><span class=si>{</span><span class=n>counts</span><span class=p>[</span><span class=s1>&#39;completion_tokens&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>, total_tokens: </span><span class=si>{</span><span class=n>counts</span><span class=p>[</span><span class=s1>&#39;total_tokens&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
<a id=__codelineno-0-1152 name=__codelineno-0-1152></a>            <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1153 name=__codelineno-0-1153></a>        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.start_logging class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">start_logging</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.start_logging class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>start_logging</span><span class=p>(</span><span class=n>history_dict</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>compact</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>reset_counter</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Start book keeping.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>history_dict</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>A dictionary for book keeping. If no provided, a new one will be created.</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><span title=Dict>Dict</span></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>compact</code> </td> <td class=doc-param-details> <div class=doc-md-description> <p>Whether to keep the history dictionary compact. Compact history contains one key per conversation, and the value is a dictionary like:</p> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href=https://docs.python.org/3/library/functions.html#bool>bool</a></code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <p><div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=p>{</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    <span class=s2>&quot;create_at&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    <span class=s2>&quot;cost&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>],</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=p>}</span>
</code></pre></div> where "created_at" is the index of API calls indicating the order of all the calls, and "cost" is the cost of each call. This example shows that the conversation is based on two API calls. The compact format is useful for condensing the history of a conversation. If compact is False, the history dictionary will contain all the API calls: the key is the index of the API call, and the value is a dictionary like: <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=p>{</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request_dict</span><span class=p>,</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>    <span class=s2>&quot;response&quot;</span><span class=p>:</span> <span class=n>response_dict</span><span class=p>,</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=p>}</span>
</code></pre></div> where request_dict is the request sent to OpenAI API, and response_dict is the response. For a conversation containing two API calls, the non-compact history dictionary will be like: <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=p>{</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=mi>0</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>        <span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request_dict_0</span><span class=p>,</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>        <span class=s2>&quot;response&quot;</span><span class=p>:</span> <span class=n>response_dict_0</span><span class=p>,</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=p>},</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>    <span class=mi>1</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>        <span class=s2>&quot;request&quot;</span><span class=p>:</span> <span class=n>request_dict_1</span><span class=p>,</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>        <span class=s2>&quot;response&quot;</span><span class=p>:</span> <span class=n>response_dict_1</span><span class=p>,</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>    <span class=p>},</span>
</code></pre></div> The first request's messages plus the response is equal to the second request's messages. For a conversation with many turns, the non-compact history dictionary has a quadratic size while the compact history dict has a linear size. reset_counter (bool): whether to reset the counter of the number of API calls.</p> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1155>1155</a></span>
<span class=normal><a href=#__codelineno-0-1156>1156</a></span>
<span class=normal><a href=#__codelineno-0-1157>1157</a></span>
<span class=normal><a href=#__codelineno-0-1158>1158</a></span>
<span class=normal><a href=#__codelineno-0-1159>1159</a></span>
<span class=normal><a href=#__codelineno-0-1160>1160</a></span>
<span class=normal><a href=#__codelineno-0-1161>1161</a></span>
<span class=normal><a href=#__codelineno-0-1162>1162</a></span>
<span class=normal><a href=#__codelineno-0-1163>1163</a></span>
<span class=normal><a href=#__codelineno-0-1164>1164</a></span>
<span class=normal><a href=#__codelineno-0-1165>1165</a></span>
<span class=normal><a href=#__codelineno-0-1166>1166</a></span>
<span class=normal><a href=#__codelineno-0-1167>1167</a></span>
<span class=normal><a href=#__codelineno-0-1168>1168</a></span>
<span class=normal><a href=#__codelineno-0-1169>1169</a></span>
<span class=normal><a href=#__codelineno-0-1170>1170</a></span>
<span class=normal><a href=#__codelineno-0-1171>1171</a></span>
<span class=normal><a href=#__codelineno-0-1172>1172</a></span>
<span class=normal><a href=#__codelineno-0-1173>1173</a></span>
<span class=normal><a href=#__codelineno-0-1174>1174</a></span>
<span class=normal><a href=#__codelineno-0-1175>1175</a></span>
<span class=normal><a href=#__codelineno-0-1176>1176</a></span>
<span class=normal><a href=#__codelineno-0-1177>1177</a></span>
<span class=normal><a href=#__codelineno-0-1178>1178</a></span>
<span class=normal><a href=#__codelineno-0-1179>1179</a></span>
<span class=normal><a href=#__codelineno-0-1180>1180</a></span>
<span class=normal><a href=#__codelineno-0-1181>1181</a></span>
<span class=normal><a href=#__codelineno-0-1182>1182</a></span>
<span class=normal><a href=#__codelineno-0-1183>1183</a></span>
<span class=normal><a href=#__codelineno-0-1184>1184</a></span>
<span class=normal><a href=#__codelineno-0-1185>1185</a></span>
<span class=normal><a href=#__codelineno-0-1186>1186</a></span>
<span class=normal><a href=#__codelineno-0-1187>1187</a></span>
<span class=normal><a href=#__codelineno-0-1188>1188</a></span>
<span class=normal><a href=#__codelineno-0-1189>1189</a></span>
<span class=normal><a href=#__codelineno-0-1190>1190</a></span>
<span class=normal><a href=#__codelineno-0-1191>1191</a></span>
<span class=normal><a href=#__codelineno-0-1192>1192</a></span>
<span class=normal><a href=#__codelineno-0-1193>1193</a></span>
<span class=normal><a href=#__codelineno-0-1194>1194</a></span>
<span class=normal><a href=#__codelineno-0-1195>1195</a></span>
<span class=normal><a href=#__codelineno-0-1196>1196</a></span>
<span class=normal><a href=#__codelineno-0-1197>1197</a></span>
<span class=normal><a href=#__codelineno-0-1198>1198</a></span>
<span class=normal><a href=#__codelineno-0-1199>1199</a></span>
<span class=normal><a href=#__codelineno-0-1200>1200</a></span>
<span class=normal><a href=#__codelineno-0-1201>1201</a></span>
<span class=normal><a href=#__codelineno-0-1202>1202</a></span>
<span class=normal><a href=#__codelineno-0-1203>1203</a></span>
<span class=normal><a href=#__codelineno-0-1204>1204</a></span>
<span class=normal><a href=#__codelineno-0-1205>1205</a></span>
<span class=normal><a href=#__codelineno-0-1206>1206</a></span>
<span class=normal><a href=#__codelineno-0-1207>1207</a></span>
<span class=normal><a href=#__codelineno-0-1208>1208</a></span>
<span class=normal><a href=#__codelineno-0-1209>1209</a></span>
<span class=normal><a href=#__codelineno-0-1210>1210</a></span>
<span class=normal><a href=#__codelineno-0-1211>1211</a></span>
<span class=normal><a href=#__codelineno-0-1212>1212</a></span>
<span class=normal><a href=#__codelineno-0-1213>1213</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1155 name=__codelineno-0-1155></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-1156 name=__codelineno-0-1156></a><span class=k>def</span><span class=w> </span><span class=nf>start_logging</span><span class=p>(</span>
<a id=__codelineno-0-1157 name=__codelineno-0-1157></a>    <span class=bp>cls</span><span class=p>,</span>
<a id=__codelineno-0-1158 name=__codelineno-0-1158></a>    <span class=n>history_dict</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-1159 name=__codelineno-0-1159></a>    <span class=n>compact</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1160 name=__codelineno-0-1160></a>    <span class=n>reset_counter</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-0-1161 name=__codelineno-0-1161></a><span class=p>):</span>
<a id=__codelineno-0-1162 name=__codelineno-0-1162></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Start book keeping.</span>
<a id=__codelineno-0-1163 name=__codelineno-0-1163></a>
<a id=__codelineno-0-1164 name=__codelineno-0-1164></a><span class=sd>    Args:</span>
<a id=__codelineno-0-1165 name=__codelineno-0-1165></a><span class=sd>        history_dict (Dict): A dictionary for book keeping.</span>
<a id=__codelineno-0-1166 name=__codelineno-0-1166></a><span class=sd>            If no provided, a new one will be created.</span>
<a id=__codelineno-0-1167 name=__codelineno-0-1167></a><span class=sd>        compact (bool): Whether to keep the history dictionary compact.</span>
<a id=__codelineno-0-1168 name=__codelineno-0-1168></a><span class=sd>            Compact history contains one key per conversation, and the value is a dictionary</span>
<a id=__codelineno-0-1169 name=__codelineno-0-1169></a><span class=sd>            like:</span>
<a id=__codelineno-0-1170 name=__codelineno-0-1170></a><span class=sd>    ```python</span>
<a id=__codelineno-0-1171 name=__codelineno-0-1171></a><span class=sd>    {</span>
<a id=__codelineno-0-1172 name=__codelineno-0-1172></a><span class=sd>        &quot;create_at&quot;: [0, 1],</span>
<a id=__codelineno-0-1173 name=__codelineno-0-1173></a><span class=sd>        &quot;cost&quot;: [0.1, 0.2],</span>
<a id=__codelineno-0-1174 name=__codelineno-0-1174></a><span class=sd>    }</span>
<a id=__codelineno-0-1175 name=__codelineno-0-1175></a><span class=sd>    ```</span>
<a id=__codelineno-0-1176 name=__codelineno-0-1176></a><span class=sd>            where &quot;created_at&quot; is the index of API calls indicating the order of all the calls,</span>
<a id=__codelineno-0-1177 name=__codelineno-0-1177></a><span class=sd>            and &quot;cost&quot; is the cost of each call. This example shows that the conversation is based</span>
<a id=__codelineno-0-1178 name=__codelineno-0-1178></a><span class=sd>            on two API calls. The compact format is useful for condensing the history of a conversation.</span>
<a id=__codelineno-0-1179 name=__codelineno-0-1179></a><span class=sd>            If compact is False, the history dictionary will contain all the API calls: the key</span>
<a id=__codelineno-0-1180 name=__codelineno-0-1180></a><span class=sd>            is the index of the API call, and the value is a dictionary like:</span>
<a id=__codelineno-0-1181 name=__codelineno-0-1181></a><span class=sd>    ```python</span>
<a id=__codelineno-0-1182 name=__codelineno-0-1182></a><span class=sd>    {</span>
<a id=__codelineno-0-1183 name=__codelineno-0-1183></a><span class=sd>        &quot;request&quot;: request_dict,</span>
<a id=__codelineno-0-1184 name=__codelineno-0-1184></a><span class=sd>        &quot;response&quot;: response_dict,</span>
<a id=__codelineno-0-1185 name=__codelineno-0-1185></a><span class=sd>    }</span>
<a id=__codelineno-0-1186 name=__codelineno-0-1186></a><span class=sd>    ```</span>
<a id=__codelineno-0-1187 name=__codelineno-0-1187></a><span class=sd>            where request_dict is the request sent to OpenAI API, and response_dict is the response.</span>
<a id=__codelineno-0-1188 name=__codelineno-0-1188></a><span class=sd>            For a conversation containing two API calls, the non-compact history dictionary will be like:</span>
<a id=__codelineno-0-1189 name=__codelineno-0-1189></a><span class=sd>    ```python</span>
<a id=__codelineno-0-1190 name=__codelineno-0-1190></a><span class=sd>    {</span>
<a id=__codelineno-0-1191 name=__codelineno-0-1191></a><span class=sd>        0: {</span>
<a id=__codelineno-0-1192 name=__codelineno-0-1192></a><span class=sd>            &quot;request&quot;: request_dict_0,</span>
<a id=__codelineno-0-1193 name=__codelineno-0-1193></a><span class=sd>            &quot;response&quot;: response_dict_0,</span>
<a id=__codelineno-0-1194 name=__codelineno-0-1194></a><span class=sd>        },</span>
<a id=__codelineno-0-1195 name=__codelineno-0-1195></a><span class=sd>        1: {</span>
<a id=__codelineno-0-1196 name=__codelineno-0-1196></a><span class=sd>            &quot;request&quot;: request_dict_1,</span>
<a id=__codelineno-0-1197 name=__codelineno-0-1197></a><span class=sd>            &quot;response&quot;: response_dict_1,</span>
<a id=__codelineno-0-1198 name=__codelineno-0-1198></a><span class=sd>        },</span>
<a id=__codelineno-0-1199 name=__codelineno-0-1199></a><span class=sd>    ```</span>
<a id=__codelineno-0-1200 name=__codelineno-0-1200></a><span class=sd>            The first request&#39;s messages plus the response is equal to the second request&#39;s messages.</span>
<a id=__codelineno-0-1201 name=__codelineno-0-1201></a><span class=sd>            For a conversation with many turns, the non-compact history dictionary has a quadratic size</span>
<a id=__codelineno-0-1202 name=__codelineno-0-1202></a><span class=sd>            while the compact history dict has a linear size.</span>
<a id=__codelineno-0-1203 name=__codelineno-0-1203></a><span class=sd>        reset_counter (bool): whether to reset the counter of the number of API calls.</span>
<a id=__codelineno-0-1204 name=__codelineno-0-1204></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-1205 name=__codelineno-0-1205></a>    <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
<a id=__codelineno-0-1206 name=__codelineno-0-1206></a>        <span class=s2>&quot;logging via Completion.start_logging is deprecated in autogen and pyautogen v0.2. &quot;</span>
<a id=__codelineno-0-1207 name=__codelineno-0-1207></a>        <span class=s2>&quot;logging via OpenAIWrapper will be added back in a future release.&quot;</span>
<a id=__codelineno-0-1208 name=__codelineno-0-1208></a>    <span class=p>)</span>
<a id=__codelineno-0-1209 name=__codelineno-0-1209></a>    <span class=k>if</span> <span class=n>ERROR</span><span class=p>:</span>
<a id=__codelineno-0-1210 name=__codelineno-0-1210></a>        <span class=k>raise</span> <span class=n>ERROR</span>
<a id=__codelineno-0-1211 name=__codelineno-0-1211></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_history_dict</span> <span class=o>=</span> <span class=p>{}</span> <span class=k>if</span> <span class=n>history_dict</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>history_dict</span>
<a id=__codelineno-0-1212 name=__codelineno-0-1212></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_history_compact</span> <span class=o>=</span> <span class=n>compact</span>
<a id=__codelineno-0-1213 name=__codelineno-0-1213></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_count_create</span> <span class=o>=</span> <span class=mi>0</span> <span class=k>if</span> <span class=n>reset_counter</span> <span class=ow>or</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_count_create</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_count_create</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=autogen.ChatCompletion.stop_logging class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">stop_logging</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small> </span> <a href=#autogen.ChatCompletion.stop_logging class=headerlink title="Permanent link">#</a></h3> <div class="doc-signature highlight"><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nf>stop_logging</span><span class=p>()</span>
</code></pre></div> <div class="doc doc-contents "> <p>End book keeping.</p> <details class=quote> <summary>Source code in <code>autogen/oai/completion.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1215>1215</a></span>
<span class=normal><a href=#__codelineno-0-1216>1216</a></span>
<span class=normal><a href=#__codelineno-0-1217>1217</a></span>
<span class=normal><a href=#__codelineno-0-1218>1218</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1215 name=__codelineno-0-1215></a><span class=nd>@classmethod</span>
<a id=__codelineno-0-1216 name=__codelineno-0-1216></a><span class=k>def</span><span class=w> </span><span class=nf>stop_logging</span><span class=p>(</span><span class=bp>cls</span><span class=p>):</span>
<a id=__codelineno-0-1217 name=__codelineno-0-1217></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;End book keeping.&quot;&quot;&quot;</span>
<a id=__codelineno-0-1218 name=__codelineno-0-1218></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_history_dict</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_count_create</span> <span class=o>=</span> <span class=kc>None</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-03-02T17:05:31+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-03-02</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../Cache/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Cache"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Cache </div> </div> </a> <a href=../ChatResult/ class="md-footer__link md-footer__link--next" aria-label="Next: ChatResult"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> ChatResult </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2025 <a href=https://ag2.ai/ target=_blank rel=noopener>ag2</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/pAbnFJrkgZ target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://github.com/ag2ai/ag2 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> <a href=https://x.com/ag2oss target=_blank rel=noopener title=x.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://www.youtube.com/@ag2ai target=_blank rel=noopener title=www.youtube.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg> </a> <a href=https://www.linkedin.com/company/ag2ai target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["search.suggest", "search.highlight", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.tracking", "navigation.prune", "navigation.top", "navigation.footer", "content.tabs.link", "content.code.copy", "content.code.annotate", "content.action.edit"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.f1b6f286.min.js></script> <script src=../../../../js/timeago.min.js></script> <script src=../../../../js/timeago_mkdocs_material.js></script> <script src=../../../../javascripts/extra.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>